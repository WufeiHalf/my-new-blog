{"meta":{"version":1,"warehouse":"6.0.0"},"models":{"Asset":[{"_id":"source/user-avatar.jpg","path":"user-avatar.jpg","modified":1,"renderable":0},{"_id":"node_modules/hexo-theme-aurora/source/favicon.ico","path":"favicon.ico","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/icons/favicon-16x16.png","path":"icons/favicon-16x16.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/icons/favicon-32x32.png","path":"icons/favicon-32x32.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/886a749e.css","path":"static/886a749e.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/css/3e25f349.css","path":"static/css/3e25f349.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/css/6b275704.css","path":"static/css/6b275704.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/css/882f9706.css","path":"static/css/882f9706.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/css/8e0e69c4.css","path":"static/css/8e0e69c4.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/css/9a0271b0.css","path":"static/css/9a0271b0.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/css/a14e1a22.css","path":"static/css/a14e1a22.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/img/dccf965f.jpg","path":"static/img/dccf965f.jpg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/120aa8f8.js","path":"static/js/120aa8f8.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/22ac7e7f.js","path":"static/js/22ac7e7f.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/36429e9b.js","path":"static/js/36429e9b.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/415fa29b.js","path":"static/js/415fa29b.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/53ed1a6f.js","path":"static/js/53ed1a6f.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/7d897144.js","path":"static/js/7d897144.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/7e80f274.js","path":"static/js/7e80f274.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/8da07a12.js","path":"static/js/8da07a12.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/9aa0d897.js","path":"static/js/9aa0d897.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/9cb479b5.js","path":"static/js/9cb479b5.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/a92e6a1c.js","path":"static/js/a92e6a1c.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/c562793b.js","path":"static/js/c562793b.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/d57a5994.js","path":"static/js/d57a5994.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/ff251d5d.js","path":"static/js/ff251d5d.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-aurora/source/static/js/fffbee97.js","path":"static/js/fffbee97.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/user-avatar.jpg","hash":"5aae89f1d3925f2c862c27dfc31882b8cec9d996","modified":1770108753244},{"_id":"source/_discarded/hello-world.md","hash":"6c201026559fbdc6944513fa210d775f198be4ba","modified":1770108979279},{"_id":"source/_posts/Hexo-Aurora-Setup.md","hash":"786076e90efb01909717ba8cfcddd32a1b02ca47","modified":1770111175188},{"_id":"source/_posts/Home-Assistant-OpenClaw.md","hash":"623651e086104117b27db135705ef555b9de0feb","modified":1770111034918},{"_id":"source/_posts/OpenClaw-QQBot-Integration.md","hash":"9f3ada8c18b7345caefea16ef7eedf71534ba59a","modified":1770117736140},{"_id":"source/_posts/nvm-multi-registry-config.md","hash":"0d7d9c137324cce5468382acba4e11f7b03c70e7","modified":1770173169623},{"_id":"source/about/index.md","hash":"d4fd13260ee6368afe8c8d3702d6fa678d9b43e1","modified":1770110732566},{"_id":"node_modules/hexo-theme-aurora/LICENSE","hash":"21cf269018b0cf04e1126b6b9b1a5e6af7c5e61f","modified":1770107815794},{"_id":"node_modules/hexo-theme-aurora/README.md","hash":"8b5aea1bd91a6428040ec154ef313d20129fd1ce","modified":1770107816874},{"_id":"node_modules/hexo-theme-aurora/package.json","hash":"953a91ce5eb62368e3fe1d335e8ccd024983b4fb","modified":1770107816870},{"_id":"node_modules/hexo-theme-aurora/layout/index.ejs","hash":"c5825d6aed607fd4c5d85d261aed39e2d9d59c81","modified":1770107816386},{"_id":"node_modules/hexo-theme-aurora/public/favicon.ico","hash":"c39d3ad80489cffed0d3df82c8cb05a049ab39a3","modified":1770107816406},{"_id":"node_modules/hexo-theme-aurora/source/favicon.ico","hash":"c39d3ad80489cffed0d3df82c8cb05a049ab39a3","modified":1770107816430},{"_id":"node_modules/hexo-theme-aurora/public/icons/favicon-16x16.png","hash":"849cad2a5ae49fa54c20372f7a21ae95192bafcf","modified":1770107816878},{"_id":"node_modules/hexo-theme-aurora/public/icons/favicon-32x32.png","hash":"9dbabf6f4d825da99dcb2e91583755ae8d3b3ff4","modified":1770107816890},{"_id":"node_modules/hexo-theme-aurora/source/icons/favicon-32x32.png","hash":"9dbabf6f4d825da99dcb2e91583755ae8d3b3ff4","modified":1770107816894},{"_id":"node_modules/hexo-theme-aurora/source/icons/favicon-16x16.png","hash":"849cad2a5ae49fa54c20372f7a21ae95192bafcf","modified":1770107816886},{"_id":"node_modules/hexo-theme-aurora/source/static/886a749e.css","hash":"46ef385b52d11142f603d0916042be66e4e04b46","modified":1770107816234},{"_id":"node_modules/hexo-theme-aurora/source/static/css/3e25f349.css","hash":"2859941dbaabcdf25bfb6379a0efaf6b02b45971","modified":1770107815886},{"_id":"node_modules/hexo-theme-aurora/source/static/css/6b275704.css","hash":"b04a2cd1a356e16cded5392bad271ce2f5b1c455","modified":1770107816018},{"_id":"node_modules/hexo-theme-aurora/source/static/css/882f9706.css","hash":"156eb90b06b5f6f6f0bf24973874ecd85906f8fd","modified":1770107816218},{"_id":"node_modules/hexo-theme-aurora/source/static/css/8e0e69c4.css","hash":"5e2ac4baf9923ea59d1dbddccb44a0e4ffbdc87f","modified":1770107816274},{"_id":"node_modules/hexo-theme-aurora/source/static/css/9a0271b0.css","hash":"140052b8339ae6633bfdb6544050ba97c72ee630","modified":1770107816310},{"_id":"node_modules/hexo-theme-aurora/source/static/img/dccf965f.jpg","hash":"1934ace0c6f2397d15729f9b08cc4d42e45bf437","modified":1770107816490},{"_id":"node_modules/hexo-theme-aurora/source/static/js/22ac7e7f.js","hash":"cdc1e66e812e4ce762170e6c2008a89ddb50ac22","modified":1770107816706},{"_id":"node_modules/hexo-theme-aurora/source/static/js/36429e9b.js","hash":"f1eb144273d1914ffd000cd6ab8ebf4603566fa1","modified":1770107816714},{"_id":"node_modules/hexo-theme-aurora/source/static/js/415fa29b.js","hash":"8bbf6514805e9634eeb37d58ab9476fe7b4acab9","modified":1770107816722},{"_id":"node_modules/hexo-theme-aurora/source/static/js/53ed1a6f.js","hash":"392525c36d6f623723427c09a42cc7178f0aa65c","modified":1770107816734},{"_id":"node_modules/hexo-theme-aurora/source/static/js/7d897144.js","hash":"bc14613b9e836e8802949241e443176c3923a4ae","modified":1770107816742},{"_id":"node_modules/hexo-theme-aurora/source/static/js/7e80f274.js","hash":"3e055cf0e8e1e795571b0ac307ebd9d055874bd9","modified":1770107816750},{"_id":"node_modules/hexo-theme-aurora/source/static/js/8da07a12.js","hash":"bbf25dc2749fc8ec6cd379e69a27d5e5ee116da1","modified":1770107816790},{"_id":"node_modules/hexo-theme-aurora/source/static/js/9aa0d897.js","hash":"da073d8793e58e2bd92cd879d753966950ea6d7e","modified":1770107816802},{"_id":"node_modules/hexo-theme-aurora/source/static/js/9cb479b5.js","hash":"41d6681d53d8ca77f4df159d831237550a80939c","modified":1770107816814},{"_id":"node_modules/hexo-theme-aurora/source/static/js/a92e6a1c.js","hash":"15838a598d2c67734d4e28d6667a148e3315862f","modified":1770107816834},{"_id":"node_modules/hexo-theme-aurora/source/static/js/c562793b.js","hash":"ef13be62aaee32758e059e625e6b85504c53f822","modified":1770107816842},{"_id":"node_modules/hexo-theme-aurora/source/static/js/d57a5994.js","hash":"baeabc2ef1f3ed1b2f651a436032cedc42e16d78","modified":1770107816850},{"_id":"node_modules/hexo-theme-aurora/source/static/js/ff251d5d.js","hash":"21fe31757fa0993c2a3d34009b8fa19e421e4dfb","modified":1770107816862},{"_id":"node_modules/hexo-theme-aurora/source/static/js/fffbee97.js","hash":"6a539112698cb0925ea4da8af22f3e8cdc554e3f","modified":1770107816870},{"_id":"node_modules/hexo-theme-aurora/source/static/css/a14e1a22.css","hash":"d4f364239f1c63b66b9917062e6a7cd9fa26fcba","modified":1770107816374},{"_id":"node_modules/hexo-theme-aurora/source/static/js/120aa8f8.js","hash":"6f222242612007cdd5ba9a6d49237854c0716960","modified":1770109826131},{"_id":"public/api/posts/1.json","hash":"cc09f023f5fb032cd9de6611ab395b179f649f55","modified":1770173172932},{"_id":"public/api/archives/1.json","hash":"cc09f023f5fb032cd9de6611ab395b179f649f55","modified":1770173172932},{"_id":"public/api/articles/nvm-multi-registry-config.json","hash":"6e7f918594429796581ad5fde6b1d32e9e5393f1","modified":1770173172932},{"_id":"public/api/articles/Hexo-Aurora-Setup.json","hash":"4131a7c02e8e2b879c56026605e4d4fc4edd5682","modified":1770173172932},{"_id":"public/api/articles/OpenClaw-QQBot-Integration.json","hash":"45c722f6bfddeae8fc5ab6578f86c159f8460ea7","modified":1770173172932},{"_id":"public/api/articles/Home-Assistant-OpenClaw.json","hash":"352f20c755508933d33e96c6030c472f311b3a24","modified":1770173172932},{"_id":"public/api/features.json","hash":"c7861e30c7455cbd64b5e79eef126e5e2013b410","modified":1770173172932},{"_id":"public/api/authors/blog-author.json","hash":"6129bc73f8c5910a4d32a456dcf2660e34bf5d83","modified":1770173172932},{"_id":"public/api/categories.json","hash":"992bfd10ee1eb3140542b864d15b1465280e00d0","modified":1770173172932},{"_id":"public/api/categories/服务器.json","hash":"d6124917afec24c5e7ba3717220ac5e1d058148e","modified":1770173172932},{"_id":"public/api/categories/前端相关.json","hash":"3de5066acae069f39d5406da57322036d970c271","modified":1770173172932},{"_id":"public/api/tags.json","hash":"1e4754442d769fc8ddc0f26af954968305b72fa0","modified":1770173172932},{"_id":"public/api/tags/服务器.json","hash":"18e5b157ffa80af44c16de8cd01bf03f29265b54","modified":1770173172932},{"_id":"public/api/tags/博客配置.json","hash":"b1cbc593744b66ae4dfa334d90333e91db4210ee","modified":1770173172932},{"_id":"public/api/tags/瞎鼓捣.json","hash":"7f63240876c8806daa133e644039481a6f6ddea1","modified":1770173172932},{"_id":"public/api/tags/openclaw代笔.json","hash":"e608a51bda7e02c1b9569bfd783a8235899be9de","modified":1770173172932},{"_id":"public/api/tags/openclaw.json","hash":"3c4993865283cdeacce932e123b6c1438d902e9b","modified":1770173172932},{"_id":"public/api/tags/第三方服务.json","hash":"1aada20cd288b5d0366ed12c4a88ab2172d9832e","modified":1770173172932},{"_id":"public/api/tags/环境配置.json","hash":"bdc7f28b197ef823078c039532459a0036737008","modified":1770173172932},{"_id":"public/api/tags/nvm.json","hash":"e04b96d459fec3615627432fdefc6cd2fb2e5681","modified":1770173172932},{"_id":"public/api/tags/node版本.json","hash":"30d62dda4d0d7401889801b12d223d7fedeb308e","modified":1770173172932},{"_id":"public/api/tags/前端配置.json","hash":"95d6c4e5ede0dc9959511cf5f7244968315095ae","modified":1770173172932},{"_id":"public/api/tags/工作积累.json","hash":"a873fd9c27d0953533ba59236de70a632a9c58f7","modified":1770173172932},{"_id":"public/api/tags/AI.json","hash":"46b79bd8f94da62f7d236fd1e30ad465d7a225ce","modified":1770173172932},{"_id":"public/api/tags/home-assistant.json","hash":"0c30c41ff217995dc67766c3d42db7adaeddc81b","modified":1770173172932},{"_id":"public/api/pages/about/index.json","hash":"f9391deaacc1fbac2e9f1ed9fc3d5967f31b494f","modified":1770173172932},{"_id":"public/api/statistic.json","hash":"7ad82319f8bca079e9991b45cbfb4f29e71dc17b","modified":1770173172932},{"_id":"public/api/search.json","hash":"e3bb00b50536fc38cd9dfb5b616c30004ed05e74","modified":1770173172932},{"_id":"public/api/site.json","hash":"2805e5bf68e1540dbf37e581a655fddce30f5f32","modified":1770173172932},{"_id":"public/post/nvm-multi-registry-config.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/post/Hexo-Aurora-Setup.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/post/OpenClaw-QQBot-Integration.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/post/Home-Assistant-OpenClaw.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/index.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/tags/index.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/archives/index.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/page/about/index.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/tags/search/index.html","hash":"6831d07515c5fb226acdec739e3c5828f5e38f31","modified":1770173172932},{"_id":"public/user-avatar.jpg","hash":"5aae89f1d3925f2c862c27dfc31882b8cec9d996","modified":1770173172932},{"_id":"public/favicon.ico","hash":"c39d3ad80489cffed0d3df82c8cb05a049ab39a3","modified":1770173172932},{"_id":"public/icons/favicon-16x16.png","hash":"849cad2a5ae49fa54c20372f7a21ae95192bafcf","modified":1770173172932},{"_id":"public/icons/favicon-32x32.png","hash":"9dbabf6f4d825da99dcb2e91583755ae8d3b3ff4","modified":1770173172932},{"_id":"public/static/img/dccf965f.jpg","hash":"1934ace0c6f2397d15729f9b08cc4d42e45bf437","modified":1770173172932},{"_id":"public/static/886a749e.css","hash":"46ef385b52d11142f603d0916042be66e4e04b46","modified":1770173172932},{"_id":"public/static/css/3e25f349.css","hash":"2859941dbaabcdf25bfb6379a0efaf6b02b45971","modified":1770173172932},{"_id":"public/static/css/6b275704.css","hash":"b04a2cd1a356e16cded5392bad271ce2f5b1c455","modified":1770173172932},{"_id":"public/static/css/882f9706.css","hash":"156eb90b06b5f6f6f0bf24973874ecd85906f8fd","modified":1770173172932},{"_id":"public/static/css/8e0e69c4.css","hash":"5e2ac4baf9923ea59d1dbddccb44a0e4ffbdc87f","modified":1770173172932},{"_id":"public/static/css/9a0271b0.css","hash":"140052b8339ae6633bfdb6544050ba97c72ee630","modified":1770173172932},{"_id":"public/static/css/a14e1a22.css","hash":"d4f364239f1c63b66b9917062e6a7cd9fa26fcba","modified":1770173172932},{"_id":"public/static/js/120aa8f8.js","hash":"6f222242612007cdd5ba9a6d49237854c0716960","modified":1770173172932},{"_id":"public/static/js/22ac7e7f.js","hash":"cdc1e66e812e4ce762170e6c2008a89ddb50ac22","modified":1770173172932},{"_id":"public/static/js/36429e9b.js","hash":"f1eb144273d1914ffd000cd6ab8ebf4603566fa1","modified":1770173172932},{"_id":"public/static/js/415fa29b.js","hash":"8bbf6514805e9634eeb37d58ab9476fe7b4acab9","modified":1770173172932},{"_id":"public/static/js/53ed1a6f.js","hash":"392525c36d6f623723427c09a42cc7178f0aa65c","modified":1770173172932},{"_id":"public/static/js/7d897144.js","hash":"bc14613b9e836e8802949241e443176c3923a4ae","modified":1770173172932},{"_id":"public/static/js/7e80f274.js","hash":"3e055cf0e8e1e795571b0ac307ebd9d055874bd9","modified":1770173172932},{"_id":"public/static/js/8da07a12.js","hash":"bbf25dc2749fc8ec6cd379e69a27d5e5ee116da1","modified":1770173172932},{"_id":"public/static/js/9aa0d897.js","hash":"da073d8793e58e2bd92cd879d753966950ea6d7e","modified":1770173172932},{"_id":"public/static/js/9cb479b5.js","hash":"41d6681d53d8ca77f4df159d831237550a80939c","modified":1770173172932},{"_id":"public/static/js/a92e6a1c.js","hash":"15838a598d2c67734d4e28d6667a148e3315862f","modified":1770173172932},{"_id":"public/static/js/c562793b.js","hash":"ef13be62aaee32758e059e625e6b85504c53f822","modified":1770173172932},{"_id":"public/static/js/d57a5994.js","hash":"baeabc2ef1f3ed1b2f651a436032cedc42e16d78","modified":1770173172932},{"_id":"public/static/js/ff251d5d.js","hash":"21fe31757fa0993c2a3d34009b8fa19e421e4dfb","modified":1770173172932},{"_id":"public/static/js/fffbee97.js","hash":"6a539112698cb0925ea4da8af22f3e8cdc554e3f","modified":1770173172932}],"Category":[{"name":"服务器","_id":"cuid-gl2pTrS9aQb73bdQmI9J"},{"name":"前端相关","_id":"cuidJ2OVrDiKImc5d8G19wLn_"}],"Data":[],"Page":[{"_content":"# 关于我\n\n你好，我是 **wufei**。\n目前主要在折腾和学习这几块儿：\n\n- AI & 大模型相关\n- 前端开发（Vue / React / JavaScript）\n- 自托管服务 & 各种小玩具\n\n这个博客对我来说，更像是一个「**长期可控的技术记忆仓库**」，方便未来的自己回看和复用。\n\n---\n\n## 这个博客会写些什么？\n\n主要会围绕这些主题：\n\n- **AI & 大模型**\n  - Claude / GPT / Codex 等模型的使用经验\n  - 提示词、自动化工作流、一些实践踩坑记录\n  - OpenClaw / Clawdbot 等相关折腾笔记\n\n- **前端技术**\n  - Vue / React / JS 相关笔记\n  - 前端工程化（构建、部署、性能优化等）\n  - 各种自动化脚本 & 小工具实践\n\n- **自托管 & 折腾记录**\n  - 雨云 VPS 上的各种服务搭建（Hexo 博客、OpenClaw、Home Assistant 等）\n  - 智能家居、自动化流程\n  - 一些有趣的硬件 / 软件小玩具\n\n当前的定位是「**个人笔记 + 折腾记录**」，不是那种很正式的教程站，所以：\n\n- 文章里的配置、脚本主要是写给「未来的自己」看的备忘；\n- 有些方案可能只适用于我当前的环境；\n- 如果你看到明显错误或更好的做法，非常欢迎告诉我。\n\n---\n\n## 关于站点\n\n- 托管：雨云 VPS（Ubuntu 22.04）\n- 博客引擎：Hexo\n- 主题：Aurora\n- 面板：1Panel\n- 域名：`wfcloudfare.xyz`\n\n后面如果有比较大的架构变动，我也会尽量在这里补充说明。\n\n---\n\n## 联系我\n\n如果你对文章内容有建议 / 纠正 / 交流，欢迎通过以下方式联系：\n\n- 📧 邮箱：**wu2276671797@163.com**\n\n也欢迎在文章评论区留言（如果当前页面支持评论的话），我看到后会尽量回复。\n\n---\n\n## 协议 & 转载\n\n除非特别声明，本博客内容遵循：\n\n> **CC BY-NC-SA 4.0**  \n> 署名 - 非商业性使用 - 相同方式共享\n\n简单说就是：\n\n- 可以转、可以引用，但请**注明原作者（wufei）并附上原文链接**；\n- 不用于商业用途；\n- 进行二次创作时，请保持**相同协议**进行共享。\n\n如果你的使用场景比较特殊，或者不确定是否符合协议，给我发个邮件聊聊就好。\n","source":"about/index.md","raw":"# 关于我\n\n你好，我是 **wufei**。\n目前主要在折腾和学习这几块儿：\n\n- AI & 大模型相关\n- 前端开发（Vue / React / JavaScript）\n- 自托管服务 & 各种小玩具\n\n这个博客对我来说，更像是一个「**长期可控的技术记忆仓库**」，方便未来的自己回看和复用。\n\n---\n\n## 这个博客会写些什么？\n\n主要会围绕这些主题：\n\n- **AI & 大模型**\n  - Claude / GPT / Codex 等模型的使用经验\n  - 提示词、自动化工作流、一些实践踩坑记录\n  - OpenClaw / Clawdbot 等相关折腾笔记\n\n- **前端技术**\n  - Vue / React / JS 相关笔记\n  - 前端工程化（构建、部署、性能优化等）\n  - 各种自动化脚本 & 小工具实践\n\n- **自托管 & 折腾记录**\n  - 雨云 VPS 上的各种服务搭建（Hexo 博客、OpenClaw、Home Assistant 等）\n  - 智能家居、自动化流程\n  - 一些有趣的硬件 / 软件小玩具\n\n当前的定位是「**个人笔记 + 折腾记录**」，不是那种很正式的教程站，所以：\n\n- 文章里的配置、脚本主要是写给「未来的自己」看的备忘；\n- 有些方案可能只适用于我当前的环境；\n- 如果你看到明显错误或更好的做法，非常欢迎告诉我。\n\n---\n\n## 关于站点\n\n- 托管：雨云 VPS（Ubuntu 22.04）\n- 博客引擎：Hexo\n- 主题：Aurora\n- 面板：1Panel\n- 域名：`wfcloudfare.xyz`\n\n后面如果有比较大的架构变动，我也会尽量在这里补充说明。\n\n---\n\n## 联系我\n\n如果你对文章内容有建议 / 纠正 / 交流，欢迎通过以下方式联系：\n\n- 📧 邮箱：**wu2276671797@163.com**\n\n也欢迎在文章评论区留言（如果当前页面支持评论的话），我看到后会尽量回复。\n\n---\n\n## 协议 & 转载\n\n除非特别声明，本博客内容遵循：\n\n> **CC BY-NC-SA 4.0**  \n> 署名 - 非商业性使用 - 相同方式共享\n\n简单说就是：\n\n- 可以转、可以引用，但请**注明原作者（wufei）并附上原文链接**；\n- 不用于商业用途；\n- 进行二次创作时，请保持**相同协议**进行共享。\n\n如果你的使用场景比较特殊，或者不确定是否符合协议，给我发个邮件聊聊就好。\n","date":"2026-02-03T09:25:32.566Z","updated":"2026-02-03T09:25:32.566Z","path":"about/index.html","title":"","comments":1,"layout":"page","_id":"cuid6Ziu-qtT-usc5FtBrjILo","content":"<h1 id=\"关于我\"><a href=\"#关于我\" class=\"headerlink\" title=\"关于我\"></a>关于我</h1><p>你好，我是 <strong>wufei</strong>。<br>目前主要在折腾和学习这几块儿：</p>\n<ul>\n<li>AI &amp; 大模型相关</li>\n<li>前端开发（Vue &#x2F; React &#x2F; JavaScript）</li>\n<li>自托管服务 &amp; 各种小玩具</li>\n</ul>\n<p>这个博客对我来说，更像是一个「<strong>长期可控的技术记忆仓库</strong>」，方便未来的自己回看和复用。</p>\n<hr>\n<h2 id=\"这个博客会写些什么？\"><a href=\"#这个博客会写些什么？\" class=\"headerlink\" title=\"这个博客会写些什么？\"></a>这个博客会写些什么？</h2><p>主要会围绕这些主题：</p>\n<ul>\n<li><p><strong>AI &amp; 大模型</strong></p>\n<ul>\n<li>Claude &#x2F; GPT &#x2F; Codex 等模型的使用经验</li>\n<li>提示词、自动化工作流、一些实践踩坑记录</li>\n<li>OpenClaw &#x2F; Clawdbot 等相关折腾笔记</li>\n</ul>\n</li>\n<li><p><strong>前端技术</strong></p>\n<ul>\n<li>Vue &#x2F; React &#x2F; JS 相关笔记</li>\n<li>前端工程化（构建、部署、性能优化等）</li>\n<li>各种自动化脚本 &amp; 小工具实践</li>\n</ul>\n</li>\n<li><p><strong>自托管 &amp; 折腾记录</strong></p>\n<ul>\n<li>雨云 VPS 上的各种服务搭建（Hexo 博客、OpenClaw、Home Assistant 等）</li>\n<li>智能家居、自动化流程</li>\n<li>一些有趣的硬件 &#x2F; 软件小玩具</li>\n</ul>\n</li>\n</ul>\n<p>当前的定位是「<strong>个人笔记 + 折腾记录</strong>」，不是那种很正式的教程站，所以：</p>\n<ul>\n<li>文章里的配置、脚本主要是写给「未来的自己」看的备忘；</li>\n<li>有些方案可能只适用于我当前的环境；</li>\n<li>如果你看到明显错误或更好的做法，非常欢迎告诉我。</li>\n</ul>\n<hr>\n<h2 id=\"关于站点\"><a href=\"#关于站点\" class=\"headerlink\" title=\"关于站点\"></a>关于站点</h2><ul>\n<li>托管：雨云 VPS（Ubuntu 22.04）</li>\n<li>博客引擎：Hexo</li>\n<li>主题：Aurora</li>\n<li>面板：1Panel</li>\n<li>域名：<code>wfcloudfare.xyz</code></li>\n</ul>\n<p>后面如果有比较大的架构变动，我也会尽量在这里补充说明。</p>\n<hr>\n<h2 id=\"联系我\"><a href=\"#联系我\" class=\"headerlink\" title=\"联系我\"></a>联系我</h2><p>如果你对文章内容有建议 &#x2F; 纠正 &#x2F; 交流，欢迎通过以下方式联系：</p>\n<ul>\n<li>📧 邮箱：<strong><a href=\"mailto:&#x77;&#117;&#x32;&#50;&#55;&#54;&#54;&#x37;&#49;&#55;&#57;&#x37;&#64;&#x31;&#x36;&#x33;&#x2e;&#99;&#111;&#109;\">wu2276671797@163.com</a></strong></li>\n</ul>\n<p>也欢迎在文章评论区留言（如果当前页面支持评论的话），我看到后会尽量回复。</p>\n<hr>\n<h2 id=\"协议-转载\"><a href=\"#协议-转载\" class=\"headerlink\" title=\"协议 &amp; 转载\"></a>协议 &amp; 转载</h2><p>除非特别声明，本博客内容遵循：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>CC BY-NC-SA 4.0</strong><br>署名 - 非商业性使用 - 相同方式共享</p></blockquote>\n<p>简单说就是：</p>\n<ul>\n<li>可以转、可以引用，但请<strong>注明原作者（wufei）并附上原文链接</strong>；</li>\n<li>不用于商业用途；</li>\n<li>进行二次创作时，请保持<strong>相同协议</strong>进行共享。</li>\n</ul>\n<p>如果你的使用场景比较特殊，或者不确定是否符合协议，给我发个邮件聊聊就好。</p>\n","excerpt":"","more":"<h1 id=\"关于我\"><a href=\"#关于我\" class=\"headerlink\" title=\"关于我\"></a>关于我</h1><p>你好，我是 <strong>wufei</strong>。<br>目前主要在折腾和学习这几块儿：</p>\n<ul>\n<li>AI &amp; 大模型相关</li>\n<li>前端开发（Vue &#x2F; React &#x2F; JavaScript）</li>\n<li>自托管服务 &amp; 各种小玩具</li>\n</ul>\n<p>这个博客对我来说，更像是一个「<strong>长期可控的技术记忆仓库</strong>」，方便未来的自己回看和复用。</p>\n<hr>\n<h2 id=\"这个博客会写些什么？\"><a href=\"#这个博客会写些什么？\" class=\"headerlink\" title=\"这个博客会写些什么？\"></a>这个博客会写些什么？</h2><p>主要会围绕这些主题：</p>\n<ul>\n<li><p><strong>AI &amp; 大模型</strong></p>\n<ul>\n<li>Claude &#x2F; GPT &#x2F; Codex 等模型的使用经验</li>\n<li>提示词、自动化工作流、一些实践踩坑记录</li>\n<li>OpenClaw &#x2F; Clawdbot 等相关折腾笔记</li>\n</ul>\n</li>\n<li><p><strong>前端技术</strong></p>\n<ul>\n<li>Vue &#x2F; React &#x2F; JS 相关笔记</li>\n<li>前端工程化（构建、部署、性能优化等）</li>\n<li>各种自动化脚本 &amp; 小工具实践</li>\n</ul>\n</li>\n<li><p><strong>自托管 &amp; 折腾记录</strong></p>\n<ul>\n<li>雨云 VPS 上的各种服务搭建（Hexo 博客、OpenClaw、Home Assistant 等）</li>\n<li>智能家居、自动化流程</li>\n<li>一些有趣的硬件 &#x2F; 软件小玩具</li>\n</ul>\n</li>\n</ul>\n<p>当前的定位是「<strong>个人笔记 + 折腾记录</strong>」，不是那种很正式的教程站，所以：</p>\n<ul>\n<li>文章里的配置、脚本主要是写给「未来的自己」看的备忘；</li>\n<li>有些方案可能只适用于我当前的环境；</li>\n<li>如果你看到明显错误或更好的做法，非常欢迎告诉我。</li>\n</ul>\n<hr>\n<h2 id=\"关于站点\"><a href=\"#关于站点\" class=\"headerlink\" title=\"关于站点\"></a>关于站点</h2><ul>\n<li>托管：雨云 VPS（Ubuntu 22.04）</li>\n<li>博客引擎：Hexo</li>\n<li>主题：Aurora</li>\n<li>面板：1Panel</li>\n<li>域名：<code>wfcloudfare.xyz</code></li>\n</ul>\n<p>后面如果有比较大的架构变动，我也会尽量在这里补充说明。</p>\n<hr>\n<h2 id=\"联系我\"><a href=\"#联系我\" class=\"headerlink\" title=\"联系我\"></a>联系我</h2><p>如果你对文章内容有建议 &#x2F; 纠正 &#x2F; 交流，欢迎通过以下方式联系：</p>\n<ul>\n<li>📧 邮箱：<strong><a href=\"mailto:&#x77;&#117;&#x32;&#50;&#55;&#54;&#54;&#x37;&#49;&#55;&#57;&#x37;&#64;&#x31;&#x36;&#x33;&#x2e;&#99;&#111;&#109;\">wu2276671797@163.com</a></strong></li>\n</ul>\n<p>也欢迎在文章评论区留言（如果当前页面支持评论的话），我看到后会尽量回复。</p>\n<hr>\n<h2 id=\"协议-转载\"><a href=\"#协议-转载\" class=\"headerlink\" title=\"协议 &amp; 转载\"></a>协议 &amp; 转载</h2><p>除非特别声明，本博客内容遵循：</p>\n<blockquote>\n<p><strong>CC BY-NC-SA 4.0</strong><br>署名 - 非商业性使用 - 相同方式共享</p>\n</blockquote>\n<p>简单说就是：</p>\n<ul>\n<li>可以转、可以引用，但请<strong>注明原作者（wufei）并附上原文链接</strong>；</li>\n<li>不用于商业用途；</li>\n<li>进行二次创作时，请保持<strong>相同协议</strong>进行共享。</li>\n</ul>\n<p>如果你的使用场景比较特殊，或者不确定是否符合协议，给我发个邮件聊聊就好。</p>\n"}],"Post":[{"title":"在这台服务器上折腾 Hexo + Aurora 的记录","author":"blog-author","date":"2026-02-03T12:30:00.000Z","_content":"\n> 这篇是给未来的自己看的「操作说明书」：这台雨云服务器上是怎么配置 Hexo + Aurora 的，平时想手动加文章、改 About、重新生成页面，都怎么搞。\n\n## 一、整体结构说明\n\n- 博客根目录：`/opt/blog`\n- 引擎：Hexo 8.x\n- 主题：`hexo-theme-aurora@2.5.3`\n- 域名：`wfcloudfare.xyz`\n- 主要配置文件：\n  - Hexo 主配置：`/opt/blog/_config.yml`\n  - Aurora 主题配置：`/opt/blog/_config.aurora.yml`\n- 源文件目录：`/opt/blog/source`\n  - 文章：`/opt/blog/source/_posts/*.md`\n  - About 页面：`/opt/blog/source/about/index.md`\n\nHexo 的工作流就是：**改 `source` 里的内容 → 运行生成命令 → 静态文件写到 `public/` 目录 → 由服务端（1Panel/openresty）对外提供访问。**\n\n---\n\n## 二、常用命令速查\n\n以下命令都在 `/opt/blog` 目录下执行：\n\n```bash\ncd /opt/blog\n\n# 清理历史生成文件（出问题先来一遍）\nnpx hexo clean\n\n# 重新生成静态文件\nnpx hexo generate\n\n# 本地预览（需要端口转发或本机调试时）\nnpx hexo server\n```\n\n如果想用 npm scripts，也可以：\n\n```bash\nnpm run clean    # 等价于 hexo clean\nnpm run build    # 等价于 hexo generate\nnpm run server   # 等价于 hexo server\n```\n\n生成完成后，Aurora 会在日志里输出类似：\n\n```text\nThanks for using: hexo-plugin-aurora v1.8.4 & hexo-theme-aurora v2.5.3\nAPI data generated with hexo-plugin-aurora v1.8.4\n```\n\n看到这些基本就说明主题侧也正常工作了。\n\n---\n\n## 三、手动添加一篇文章的完整流程\n\n示例：我想写一篇关于服务器/博客的文章，分类放在「服务器」，标签写成「服务器、博客配置、瞎鼓捣、openclaw代笔」。\n\n### 1. 新建 Markdown 文件\n\n在 `/opt/blog/source/_posts` 目录下新建一个 `*.md` 文件，比如：\n\n```bash\ncd /opt/blog/source/_posts\nnano my-first-server-note.md\n```\n\n文件内容模板可以参考下面这个（front‑matter 头部必须顶格写在最前面）：\n\n```yaml\ntitle: 我的第一篇服务器折腾记录\nauthor: blog-author\n# 不写 date 就用生成时间；也可以手动指定\ndate: 2026-02-03 21:00:00\ncategories:\n  - 服务器\ntags:\n  - 服务器\n  - 博客配置\n  - 瞎鼓捣\n  - openclaw代笔\n---\n\n这里开始就是正文内容，可以正常写 Markdown：\n\n- 支持标题、列表、代码块等\n- 图片可以放在 `source/` 下面再用相对路径引用\n\n```bash\n# 示例命令\nls -al\n```\n```\n\n说明：\n- `categories` 支持多级，比如：\n  ```yaml\n  categories:\n    - 技术\n    - 服务器\n  ```\n  Hexo 会自动生成分类页面，不需要手动注册分类。\n- `tags` 是文章级别的关键词，随便写，主题会自动生成标签页。\n\n### 2. 回到项目根目录重新生成\n\n保存文章后，回到 `/opt/blog` 目录，执行：\n\n```bash\ncd /opt/blog\nnpx hexo clean\nnpx hexo generate\n```\n\n看到类似 `Generated: api/categories/服务器.json`、`Generated: post/xxx.html` 的输出，就说明文章已经被收进去了。\n\n### 3. 访问验证\n\n生成完成后，通过域名访问博客首页或归档页面：\n\n- 首页：`https://wfcloudfare.xyz/`\n- 归档：主题会在菜单里给出入口\n\n在 Aurora 主题下，文章会自动挂到：\n\n- 首页卡片流\n- 分类页（比如「服务器」分类）\n- 归档页\n\n---\n\n## 四、About 页面在哪里改\n\n- 源文件路径：`/opt/blog/source/about/index.md`\n- 对应页面：`/public/page/about/index.html`\n- Aurora 还会生成：`/public/api/pages/about/index.json`\n\n修改步骤：\n\n1. 编辑文件：\n   ```bash\n   cd /opt/blog\n   nano source/about/index.md\n   ```\n2. 按 Markdown 写你的自我介绍/关于\n3. 保存后执行：\n   ```bash\n   npx hexo generate\n   ```\n4. 确认日志里有：\n   ```text\n   Generated: api/pages/about/index.json\n   Generated: page/about/index.html\n   ```\n\n然后访问博客导航里的 About 页面就能看到最新内容。\n\n---\n\n## 五、Aurora 主题的一些小提示\n\n- 主题路径：`/opt/blog/themes/aurora`（一般不用动源码）\n- 主题配置：`/opt/blog/_config.aurora.yml`\n- 当文章数量少于 3 篇时，Aurora 会给出提示：\n  > You need at least 3 articles to enable [FEATURE MODE], you currently have 1. [PIN MODE] is activated instead!\n  这是正常现象，多写两篇文章就会切到完整的「Feature Mode」。\n\n如果要改主题配置（例如：菜单、社交链接、头像等）：\n\n1. 编辑 `_config.aurora.yml`\n2. 保存后执行：\n   ```bash\n   cd /opt/blog\n   npx hexo clean\n   npx hexo generate\n   ```\n\n---\n\n## 六、出问题时可以怎么排查\n\n1. **页面没更新**\n   - 确认有没有执行：\n     ```bash\n     cd /opt/blog\n     npx hexo clean\n     npx hexo generate\n     ```\n   - 有缓存场景（CDN）的话注意清一下缓存。\n\n2. **新文章不显示**\n   - 检查 `_posts/*.md` 里 front‑matter 是否完整，`---` 分隔符有没有写对。\n   - `date` 是否是未来时间（未来时间的文章可能被当成未发布）。\n\n3. **主题样式乱了 / 报错**\n   - 先 `npx hexo clean` 再 `npx hexo generate`。\n   - 看终端输出有没有明显报错信息。\n\n---\n\n这一篇就当是「Hexo + Aurora 在这台服务器上的使用手册」。以后要是忘了怎么手动加文章、怎么重新生成页面，回来翻翻这篇就行。由 openclaw 代笔记录。","source":"_posts/Hexo-Aurora-Setup.md","raw":"title: 在这台服务器上折腾 Hexo + Aurora 的记录\nauthor: blog-author\ndate: 2026-02-03 20:30:00\ncategories:\n  - 服务器\ntags:\n  - 服务器\n  - 博客配置\n  - 瞎鼓捣\n  - openclaw代笔\n---\n\n> 这篇是给未来的自己看的「操作说明书」：这台雨云服务器上是怎么配置 Hexo + Aurora 的，平时想手动加文章、改 About、重新生成页面，都怎么搞。\n\n## 一、整体结构说明\n\n- 博客根目录：`/opt/blog`\n- 引擎：Hexo 8.x\n- 主题：`hexo-theme-aurora@2.5.3`\n- 域名：`wfcloudfare.xyz`\n- 主要配置文件：\n  - Hexo 主配置：`/opt/blog/_config.yml`\n  - Aurora 主题配置：`/opt/blog/_config.aurora.yml`\n- 源文件目录：`/opt/blog/source`\n  - 文章：`/opt/blog/source/_posts/*.md`\n  - About 页面：`/opt/blog/source/about/index.md`\n\nHexo 的工作流就是：**改 `source` 里的内容 → 运行生成命令 → 静态文件写到 `public/` 目录 → 由服务端（1Panel/openresty）对外提供访问。**\n\n---\n\n## 二、常用命令速查\n\n以下命令都在 `/opt/blog` 目录下执行：\n\n```bash\ncd /opt/blog\n\n# 清理历史生成文件（出问题先来一遍）\nnpx hexo clean\n\n# 重新生成静态文件\nnpx hexo generate\n\n# 本地预览（需要端口转发或本机调试时）\nnpx hexo server\n```\n\n如果想用 npm scripts，也可以：\n\n```bash\nnpm run clean    # 等价于 hexo clean\nnpm run build    # 等价于 hexo generate\nnpm run server   # 等价于 hexo server\n```\n\n生成完成后，Aurora 会在日志里输出类似：\n\n```text\nThanks for using: hexo-plugin-aurora v1.8.4 & hexo-theme-aurora v2.5.3\nAPI data generated with hexo-plugin-aurora v1.8.4\n```\n\n看到这些基本就说明主题侧也正常工作了。\n\n---\n\n## 三、手动添加一篇文章的完整流程\n\n示例：我想写一篇关于服务器/博客的文章，分类放在「服务器」，标签写成「服务器、博客配置、瞎鼓捣、openclaw代笔」。\n\n### 1. 新建 Markdown 文件\n\n在 `/opt/blog/source/_posts` 目录下新建一个 `*.md` 文件，比如：\n\n```bash\ncd /opt/blog/source/_posts\nnano my-first-server-note.md\n```\n\n文件内容模板可以参考下面这个（front‑matter 头部必须顶格写在最前面）：\n\n```yaml\ntitle: 我的第一篇服务器折腾记录\nauthor: blog-author\n# 不写 date 就用生成时间；也可以手动指定\ndate: 2026-02-03 21:00:00\ncategories:\n  - 服务器\ntags:\n  - 服务器\n  - 博客配置\n  - 瞎鼓捣\n  - openclaw代笔\n---\n\n这里开始就是正文内容，可以正常写 Markdown：\n\n- 支持标题、列表、代码块等\n- 图片可以放在 `source/` 下面再用相对路径引用\n\n```bash\n# 示例命令\nls -al\n```\n```\n\n说明：\n- `categories` 支持多级，比如：\n  ```yaml\n  categories:\n    - 技术\n    - 服务器\n  ```\n  Hexo 会自动生成分类页面，不需要手动注册分类。\n- `tags` 是文章级别的关键词，随便写，主题会自动生成标签页。\n\n### 2. 回到项目根目录重新生成\n\n保存文章后，回到 `/opt/blog` 目录，执行：\n\n```bash\ncd /opt/blog\nnpx hexo clean\nnpx hexo generate\n```\n\n看到类似 `Generated: api/categories/服务器.json`、`Generated: post/xxx.html` 的输出，就说明文章已经被收进去了。\n\n### 3. 访问验证\n\n生成完成后，通过域名访问博客首页或归档页面：\n\n- 首页：`https://wfcloudfare.xyz/`\n- 归档：主题会在菜单里给出入口\n\n在 Aurora 主题下，文章会自动挂到：\n\n- 首页卡片流\n- 分类页（比如「服务器」分类）\n- 归档页\n\n---\n\n## 四、About 页面在哪里改\n\n- 源文件路径：`/opt/blog/source/about/index.md`\n- 对应页面：`/public/page/about/index.html`\n- Aurora 还会生成：`/public/api/pages/about/index.json`\n\n修改步骤：\n\n1. 编辑文件：\n   ```bash\n   cd /opt/blog\n   nano source/about/index.md\n   ```\n2. 按 Markdown 写你的自我介绍/关于\n3. 保存后执行：\n   ```bash\n   npx hexo generate\n   ```\n4. 确认日志里有：\n   ```text\n   Generated: api/pages/about/index.json\n   Generated: page/about/index.html\n   ```\n\n然后访问博客导航里的 About 页面就能看到最新内容。\n\n---\n\n## 五、Aurora 主题的一些小提示\n\n- 主题路径：`/opt/blog/themes/aurora`（一般不用动源码）\n- 主题配置：`/opt/blog/_config.aurora.yml`\n- 当文章数量少于 3 篇时，Aurora 会给出提示：\n  > You need at least 3 articles to enable [FEATURE MODE], you currently have 1. [PIN MODE] is activated instead!\n  这是正常现象，多写两篇文章就会切到完整的「Feature Mode」。\n\n如果要改主题配置（例如：菜单、社交链接、头像等）：\n\n1. 编辑 `_config.aurora.yml`\n2. 保存后执行：\n   ```bash\n   cd /opt/blog\n   npx hexo clean\n   npx hexo generate\n   ```\n\n---\n\n## 六、出问题时可以怎么排查\n\n1. **页面没更新**\n   - 确认有没有执行：\n     ```bash\n     cd /opt/blog\n     npx hexo clean\n     npx hexo generate\n     ```\n   - 有缓存场景（CDN）的话注意清一下缓存。\n\n2. **新文章不显示**\n   - 检查 `_posts/*.md` 里 front‑matter 是否完整，`---` 分隔符有没有写对。\n   - `date` 是否是未来时间（未来时间的文章可能被当成未发布）。\n\n3. **主题样式乱了 / 报错**\n   - 先 `npx hexo clean` 再 `npx hexo generate`。\n   - 看终端输出有没有明显报错信息。\n\n---\n\n这一篇就当是「Hexo + Aurora 在这台服务器上的使用手册」。以后要是忘了怎么手动加文章、怎么重新生成页面，回来翻翻这篇就行。由 openclaw 代笔记录。","slug":"Hexo-Aurora-Setup","published":1,"updated":"2026-02-03T09:32:55.188Z","comments":1,"layout":"post","photos":[],"_id":"cuidlZMlInILL-mYReY073pq9","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这篇是给未来的自己看的「操作说明书」：这台雨云服务器上是怎么配置 Hexo + Aurora 的，平时想手动加文章、改 About、重新生成页面，都怎么搞。</p></blockquote>\n<h2 id=\"一、整体结构说明\"><a href=\"#一、整体结构说明\" class=\"headerlink\" title=\"一、整体结构说明\"></a>一、整体结构说明</h2><ul>\n<li>博客根目录：<code>/opt/blog</code></li>\n<li>引擎：Hexo 8.x</li>\n<li>主题：<code>hexo-theme-aurora@2.5.3</code></li>\n<li>域名：<code>wfcloudfare.xyz</code></li>\n<li>主要配置文件：<ul>\n<li>Hexo 主配置：<code>/opt/blog/_config.yml</code></li>\n<li>Aurora 主题配置：<code>/opt/blog/_config.aurora.yml</code></li>\n</ul>\n</li>\n<li>源文件目录：<code>/opt/blog/source</code><ul>\n<li>文章：<code>/opt/blog/source/_posts/*.md</code></li>\n<li>About 页面：<code>/opt/blog/source/about/index.md</code></li>\n</ul>\n</li>\n</ul>\n<p>Hexo 的工作流就是：<strong>改 <code>source</code> 里的内容 → 运行生成命令 → 静态文件写到 <code>public/</code> 目录 → 由服务端（1Panel&#x2F;openresty）对外提供访问。</strong></p>\n<hr>\n<h2 id=\"二、常用命令速查\"><a href=\"#二、常用命令速查\" class=\"headerlink\" title=\"二、常用命令速查\"></a>二、常用命令速查</h2><p>以下命令都在 <code>/opt/blog</code> 目录下执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 清理历史生成文件（出问题先来一遍）</span></span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重新生成静态文件</span></span><br><span class=\"line\">npx hexo generate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 本地预览（需要端口转发或本机调试时）</span></span><br><span class=\"line\">npx hexo server</span><br></pre></td></tr></table></figure>\n\n<p>如果想用 npm scripts，也可以：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run clean    <span class=\"comment\"># 等价于 hexo clean</span></span><br><span class=\"line\">npm run build    <span class=\"comment\"># 等价于 hexo generate</span></span><br><span class=\"line\">npm run server   <span class=\"comment\"># 等价于 hexo server</span></span><br></pre></td></tr></table></figure>\n\n<p>生成完成后，Aurora 会在日志里输出类似：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thanks for using: hexo-plugin-aurora v1.8.4 &amp; hexo-theme-aurora v2.5.3</span><br><span class=\"line\">API data generated with hexo-plugin-aurora v1.8.4</span><br></pre></td></tr></table></figure>\n\n<p>看到这些基本就说明主题侧也正常工作了。</p>\n<hr>\n<h2 id=\"三、手动添加一篇文章的完整流程\"><a href=\"#三、手动添加一篇文章的完整流程\" class=\"headerlink\" title=\"三、手动添加一篇文章的完整流程\"></a>三、手动添加一篇文章的完整流程</h2><p>示例：我想写一篇关于服务器&#x2F;博客的文章，分类放在「服务器」，标签写成「服务器、博客配置、瞎鼓捣、openclaw代笔」。</p>\n<h3 id=\"1-新建-Markdown-文件\"><a href=\"#1-新建-Markdown-文件\" class=\"headerlink\" title=\"1. 新建 Markdown 文件\"></a>1. 新建 Markdown 文件</h3><p>在 <code>/opt/blog/source/_posts</code> 目录下新建一个 <code>*.md</code> 文件，比如：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog/source/_posts</span><br><span class=\"line\">nano my-first-server-note.md</span><br></pre></td></tr></table></figure>\n\n<p>文件内容模板可以参考下面这个（front‑matter 头部必须顶格写在最前面）：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">我的第一篇服务器折腾记录</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">blog-author</span></span><br><span class=\"line\"><span class=\"comment\"># 不写 date 就用生成时间；也可以手动指定</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">2026-02-03 21:00:00</span></span><br><span class=\"line\"><span class=\"attr\">categories:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">服务器</span></span><br><span class=\"line\"><span class=\"attr\">tags:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">服务器</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">博客配置</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">瞎鼓捣</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">openclaw代笔</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"string\">这里开始就是正文内容，可以正常写</span> <span class=\"string\">Markdown：</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"string\">支持标题、列表、代码块等</span></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"string\">图片可以放在</span> <span class=\"string\">`source/`</span> <span class=\"string\">下面再用相对路径引用</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">```bash</span></span><br><span class=\"line\"><span class=\"comment\"># 示例命令</span></span><br><span class=\"line\"><span class=\"string\">ls</span> <span class=\"string\">-al</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">说明：</span><br><span class=\"line\">- `categories` 支持多级，比如：</span><br><span class=\"line\">  ```yaml</span><br><span class=\"line\">  categories:</span><br><span class=\"line\">    - 技术</span><br><span class=\"line\">    - 服务器</span><br></pre></td></tr></table></figure>\n<p>  Hexo 会自动生成分类页面，不需要手动注册分类。</p>\n<ul>\n<li><code>tags</code> 是文章级别的关键词，随便写，主题会自动生成标签页。</li>\n</ul>\n<h3 id=\"2-回到项目根目录重新生成\"><a href=\"#2-回到项目根目录重新生成\" class=\"headerlink\" title=\"2. 回到项目根目录重新生成\"></a>2. 回到项目根目录重新生成</h3><p>保存文章后，回到 <code>/opt/blog</code> 目录，执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>看到类似 <code>Generated: api/categories/服务器.json</code>、<code>Generated: post/xxx.html</code> 的输出，就说明文章已经被收进去了。</p>\n<h3 id=\"3-访问验证\"><a href=\"#3-访问验证\" class=\"headerlink\" title=\"3. 访问验证\"></a>3. 访问验证</h3><p>生成完成后，通过域名访问博客首页或归档页面：</p>\n<ul>\n<li>首页：<code>https://wfcloudfare.xyz/</code></li>\n<li>归档：主题会在菜单里给出入口</li>\n</ul>\n<p>在 Aurora 主题下，文章会自动挂到：</p>\n<ul>\n<li>首页卡片流</li>\n<li>分类页（比如「服务器」分类）</li>\n<li>归档页</li>\n</ul>\n<hr>\n<h2 id=\"四、About-页面在哪里改\"><a href=\"#四、About-页面在哪里改\" class=\"headerlink\" title=\"四、About 页面在哪里改\"></a>四、About 页面在哪里改</h2><ul>\n<li>源文件路径：<code>/opt/blog/source/about/index.md</code></li>\n<li>对应页面：<code>/public/page/about/index.html</code></li>\n<li>Aurora 还会生成：<code>/public/api/pages/about/index.json</code></li>\n</ul>\n<p>修改步骤：</p>\n<ol>\n<li>编辑文件：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">nano <span class=\"built_in\">source</span>/about/index.md</span><br></pre></td></tr></table></figure></li>\n<li>按 Markdown 写你的自我介绍&#x2F;关于</li>\n<li>保存后执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure></li>\n<li>确认日志里有：<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Generated: api/pages/about/index.json</span><br><span class=\"line\">Generated: page/about/index.html</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>然后访问博客导航里的 About 页面就能看到最新内容。</p>\n<hr>\n<h2 id=\"五、Aurora-主题的一些小提示\"><a href=\"#五、Aurora-主题的一些小提示\" class=\"headerlink\" title=\"五、Aurora 主题的一些小提示\"></a>五、Aurora 主题的一些小提示</h2><ul>\n<li>主题路径：<code>/opt/blog/themes/aurora</code>（一般不用动源码）</li>\n<li>主题配置：<code>/opt/blog/_config.aurora.yml</code></li>\n<li>当文章数量少于 3 篇时，Aurora 会给出提示：<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>You need at least 3 articles to enable [FEATURE MODE], you currently have 1. [PIN MODE] is activated instead!<br>这是正常现象，多写两篇文章就会切到完整的「Feature Mode」。</p></blockquote>\n</li>\n</ul>\n<p>如果要改主题配置（例如：菜单、社交链接、头像等）：</p>\n<ol>\n<li>编辑 <code>_config.aurora.yml</code></li>\n<li>保存后执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure></li>\n</ol>\n<hr>\n<h2 id=\"六、出问题时可以怎么排查\"><a href=\"#六、出问题时可以怎么排查\" class=\"headerlink\" title=\"六、出问题时可以怎么排查\"></a>六、出问题时可以怎么排查</h2><ol>\n<li><p><strong>页面没更新</strong></p>\n<ul>\n<li>确认有没有执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure></li>\n<li>有缓存场景（CDN）的话注意清一下缓存。</li>\n</ul>\n</li>\n<li><p><strong>新文章不显示</strong></p>\n<ul>\n<li>检查 <code>_posts/*.md</code> 里 front‑matter 是否完整，<code>---</code> 分隔符有没有写对。</li>\n<li><code>date</code> 是否是未来时间（未来时间的文章可能被当成未发布）。</li>\n</ul>\n</li>\n<li><p><strong>主题样式乱了 &#x2F; 报错</strong></p>\n<ul>\n<li>先 <code>npx hexo clean</code> 再 <code>npx hexo generate</code>。</li>\n<li>看终端输出有没有明显报错信息。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<p>这一篇就当是「Hexo + Aurora 在这台服务器上的使用手册」。以后要是忘了怎么手动加文章、怎么重新生成页面，回来翻翻这篇就行。由 openclaw 代笔记录。</p>\n","excerpt":"","more":"<blockquote>\n<p>这篇是给未来的自己看的「操作说明书」：这台雨云服务器上是怎么配置 Hexo + Aurora 的，平时想手动加文章、改 About、重新生成页面，都怎么搞。</p>\n</blockquote>\n<h2 id=\"一、整体结构说明\"><a href=\"#一、整体结构说明\" class=\"headerlink\" title=\"一、整体结构说明\"></a>一、整体结构说明</h2><ul>\n<li>博客根目录：<code>/opt/blog</code></li>\n<li>引擎：Hexo 8.x</li>\n<li>主题：<code>hexo-theme-aurora@2.5.3</code></li>\n<li>域名：<code>wfcloudfare.xyz</code></li>\n<li>主要配置文件：<ul>\n<li>Hexo 主配置：<code>/opt/blog/_config.yml</code></li>\n<li>Aurora 主题配置：<code>/opt/blog/_config.aurora.yml</code></li>\n</ul>\n</li>\n<li>源文件目录：<code>/opt/blog/source</code><ul>\n<li>文章：<code>/opt/blog/source/_posts/*.md</code></li>\n<li>About 页面：<code>/opt/blog/source/about/index.md</code></li>\n</ul>\n</li>\n</ul>\n<p>Hexo 的工作流就是：<strong>改 <code>source</code> 里的内容 → 运行生成命令 → 静态文件写到 <code>public/</code> 目录 → 由服务端（1Panel&#x2F;openresty）对外提供访问。</strong></p>\n<hr>\n<h2 id=\"二、常用命令速查\"><a href=\"#二、常用命令速查\" class=\"headerlink\" title=\"二、常用命令速查\"></a>二、常用命令速查</h2><p>以下命令都在 <code>/opt/blog</code> 目录下执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 清理历史生成文件（出问题先来一遍）</span></span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重新生成静态文件</span></span><br><span class=\"line\">npx hexo generate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 本地预览（需要端口转发或本机调试时）</span></span><br><span class=\"line\">npx hexo server</span><br></pre></td></tr></table></figure>\n\n<p>如果想用 npm scripts，也可以：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run clean    <span class=\"comment\"># 等价于 hexo clean</span></span><br><span class=\"line\">npm run build    <span class=\"comment\"># 等价于 hexo generate</span></span><br><span class=\"line\">npm run server   <span class=\"comment\"># 等价于 hexo server</span></span><br></pre></td></tr></table></figure>\n\n<p>生成完成后，Aurora 会在日志里输出类似：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thanks for using: hexo-plugin-aurora v1.8.4 &amp; hexo-theme-aurora v2.5.3</span><br><span class=\"line\">API data generated with hexo-plugin-aurora v1.8.4</span><br></pre></td></tr></table></figure>\n\n<p>看到这些基本就说明主题侧也正常工作了。</p>\n<hr>\n<h2 id=\"三、手动添加一篇文章的完整流程\"><a href=\"#三、手动添加一篇文章的完整流程\" class=\"headerlink\" title=\"三、手动添加一篇文章的完整流程\"></a>三、手动添加一篇文章的完整流程</h2><p>示例：我想写一篇关于服务器&#x2F;博客的文章，分类放在「服务器」，标签写成「服务器、博客配置、瞎鼓捣、openclaw代笔」。</p>\n<h3 id=\"1-新建-Markdown-文件\"><a href=\"#1-新建-Markdown-文件\" class=\"headerlink\" title=\"1. 新建 Markdown 文件\"></a>1. 新建 Markdown 文件</h3><p>在 <code>/opt/blog/source/_posts</code> 目录下新建一个 <code>*.md</code> 文件，比如：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog/source/_posts</span><br><span class=\"line\">nano my-first-server-note.md</span><br></pre></td></tr></table></figure>\n\n<p>文件内容模板可以参考下面这个（front‑matter 头部必须顶格写在最前面）：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">我的第一篇服务器折腾记录</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">blog-author</span></span><br><span class=\"line\"><span class=\"comment\"># 不写 date 就用生成时间；也可以手动指定</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">2026-02-03 21:00:00</span></span><br><span class=\"line\"><span class=\"attr\">categories:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">服务器</span></span><br><span class=\"line\"><span class=\"attr\">tags:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">服务器</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">博客配置</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">瞎鼓捣</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">openclaw代笔</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"string\">这里开始就是正文内容，可以正常写</span> <span class=\"string\">Markdown：</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"string\">支持标题、列表、代码块等</span></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"string\">图片可以放在</span> <span class=\"string\">`source/`</span> <span class=\"string\">下面再用相对路径引用</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">```bash</span></span><br><span class=\"line\"><span class=\"comment\"># 示例命令</span></span><br><span class=\"line\"><span class=\"string\">ls</span> <span class=\"string\">-al</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">说明：</span><br><span class=\"line\">- `categories` 支持多级，比如：</span><br><span class=\"line\">  ```yaml</span><br><span class=\"line\">  categories:</span><br><span class=\"line\">    - 技术</span><br><span class=\"line\">    - 服务器</span><br></pre></td></tr></table></figure>\n<p>  Hexo 会自动生成分类页面，不需要手动注册分类。</p>\n<ul>\n<li><code>tags</code> 是文章级别的关键词，随便写，主题会自动生成标签页。</li>\n</ul>\n<h3 id=\"2-回到项目根目录重新生成\"><a href=\"#2-回到项目根目录重新生成\" class=\"headerlink\" title=\"2. 回到项目根目录重新生成\"></a>2. 回到项目根目录重新生成</h3><p>保存文章后，回到 <code>/opt/blog</code> 目录，执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>看到类似 <code>Generated: api/categories/服务器.json</code>、<code>Generated: post/xxx.html</code> 的输出，就说明文章已经被收进去了。</p>\n<h3 id=\"3-访问验证\"><a href=\"#3-访问验证\" class=\"headerlink\" title=\"3. 访问验证\"></a>3. 访问验证</h3><p>生成完成后，通过域名访问博客首页或归档页面：</p>\n<ul>\n<li>首页：<code>https://wfcloudfare.xyz/</code></li>\n<li>归档：主题会在菜单里给出入口</li>\n</ul>\n<p>在 Aurora 主题下，文章会自动挂到：</p>\n<ul>\n<li>首页卡片流</li>\n<li>分类页（比如「服务器」分类）</li>\n<li>归档页</li>\n</ul>\n<hr>\n<h2 id=\"四、About-页面在哪里改\"><a href=\"#四、About-页面在哪里改\" class=\"headerlink\" title=\"四、About 页面在哪里改\"></a>四、About 页面在哪里改</h2><ul>\n<li>源文件路径：<code>/opt/blog/source/about/index.md</code></li>\n<li>对应页面：<code>/public/page/about/index.html</code></li>\n<li>Aurora 还会生成：<code>/public/api/pages/about/index.json</code></li>\n</ul>\n<p>修改步骤：</p>\n<ol>\n<li>编辑文件：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">nano <span class=\"built_in\">source</span>/about/index.md</span><br></pre></td></tr></table></figure></li>\n<li>按 Markdown 写你的自我介绍&#x2F;关于</li>\n<li>保存后执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure></li>\n<li>确认日志里有：<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Generated: api/pages/about/index.json</span><br><span class=\"line\">Generated: page/about/index.html</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>然后访问博客导航里的 About 页面就能看到最新内容。</p>\n<hr>\n<h2 id=\"五、Aurora-主题的一些小提示\"><a href=\"#五、Aurora-主题的一些小提示\" class=\"headerlink\" title=\"五、Aurora 主题的一些小提示\"></a>五、Aurora 主题的一些小提示</h2><ul>\n<li>主题路径：<code>/opt/blog/themes/aurora</code>（一般不用动源码）</li>\n<li>主题配置：<code>/opt/blog/_config.aurora.yml</code></li>\n<li>当文章数量少于 3 篇时，Aurora 会给出提示：<blockquote>\n<p>You need at least 3 articles to enable [FEATURE MODE], you currently have 1. [PIN MODE] is activated instead!<br>这是正常现象，多写两篇文章就会切到完整的「Feature Mode」。</p>\n</blockquote>\n</li>\n</ul>\n<p>如果要改主题配置（例如：菜单、社交链接、头像等）：</p>\n<ol>\n<li>编辑 <code>_config.aurora.yml</code></li>\n<li>保存后执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure></li>\n</ol>\n<hr>\n<h2 id=\"六、出问题时可以怎么排查\"><a href=\"#六、出问题时可以怎么排查\" class=\"headerlink\" title=\"六、出问题时可以怎么排查\"></a>六、出问题时可以怎么排查</h2><ol>\n<li><p><strong>页面没更新</strong></p>\n<ul>\n<li>确认有没有执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/blog</span><br><span class=\"line\">npx hexo clean</span><br><span class=\"line\">npx hexo generate</span><br></pre></td></tr></table></figure></li>\n<li>有缓存场景（CDN）的话注意清一下缓存。</li>\n</ul>\n</li>\n<li><p><strong>新文章不显示</strong></p>\n<ul>\n<li>检查 <code>_posts/*.md</code> 里 front‑matter 是否完整，<code>---</code> 分隔符有没有写对。</li>\n<li><code>date</code> 是否是未来时间（未来时间的文章可能被当成未发布）。</li>\n</ul>\n</li>\n<li><p><strong>主题样式乱了 &#x2F; 报错</strong></p>\n<ul>\n<li>先 <code>npx hexo clean</code> 再 <code>npx hexo generate</code>。</li>\n<li>看终端输出有没有明显报错信息。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<p>这一篇就当是「Hexo + Aurora 在这台服务器上的使用手册」。以后要是忘了怎么手动加文章、怎么重新生成页面，回来翻翻这篇就行。由 openclaw 代笔记录。</p>\n"},{"title":"将 OpenClaw 接入 QQ 机器人的完整实战记录","date":"2026-02-03T11:20:00.000Z","_content":"\n> 这篇是把「将 QQ 接入 OpenClaw」的全过程做一个完整记录，方便以后我自己/别人照着抄。\n\n## 前提条件\n\n- 一台可以长期在线的服务器（我这里是雨云的洛杉矶节点，Ubuntu Server 22.04）\n- OpenClaw 已经在服务器上跑起来，采用的是 **本机 `openclaw-cn` 方式**，而不是 Docker\n- 已有一个可用的 QQ 号，并可以在 QQ 开放平台创建机器人\n\n## 一、获取 QQ 机器人凭证 & 配置 IP 白名单\n\n1. 打开 QQ 开放平台：<https://q.qq.com/qqbot/#/home>\n2. 创建一个「机器人」应用（注意不是小程序/游戏）。\n3. 在「开发管理」里拿到：\n   - `AppID`\n   - `AppSecret`\n4. 在机器人配置里找到 **IP 白名单**，填入当前服务器的公网 IP。\n\n公网 IP 可以在服务器上用一条命令查出来，例如：\n\n```bash\ncurl https://myip.ipip.net\n```\n\n我这台机器返回的是：\n\n```text\n当前 IP：<你的服务器公网 IP>\n```\n\n于是就在 QQ 机器人管理后台的 IP 白名单里填了 `<你的服务器公网 IP>`。\n\n## 二、在服务器上安装 qqbot 插件\n\nOpenClaw 支持通过插件的方式接入各种渠道，QQ 对应的是社区插件 `sliverp/qqbot`。\n\n我的 OpenClaw 工作目录是 `/root/clawd`，在服务器上执行：\n\n```bash\ncd /root/clawd\n\n# 第一次使用时拉取 qqbot 插件仓库\ngit clone https://github.com/sliverp/qqbot.git\n\n# 通过 openclaw-cli 安装插件\nopenclaw-cn plugins install /root/clawd/qqbot/.\n```\n\n安装成功后日志里会出现类似：\n\n```text\nInstalling to /root/.openclaw/extensions/qqbot…\nInstalling plugin dependencies…\nInstalled plugin: qqbot\nRestart the gateway to load plugins.\n```\n\n## 三、在 OpenClaw 里添加 QQ Bot 渠道\n\n插件装好只是「有能力」接 qqbot，还需要在 OpenClaw 的渠道配置里，把 QQ 机器人账号接上来。\n\n我选择了最简单的方式：直接用命令行添加渠道，把 `AppID` 和 `AppSecret` 拼成一个 token。\n\n命令格式：\n\n```bash\nopenclaw-cn channels add --channel qqbot --token \"AppID:AppSecret\"\n```\n\n在这台服务器上的实际命令是：\n\n```bash\nopenclaw-cn channels add --channel qqbot --token \"102840004:LctBTm5Pk5RnAXvJi7XyPrJmFjDiDjGn\"\n```\n\n执行完后，用下面的命令检查渠道状态：\n\n```bash\nopenclaw-cn channels list\n```\n\n预期输出中应该能看到类似：\n\n```text\n聊天通道：\n- Feishu default: 已配置, token=config, 已启用\n- QQ Bot default: 已配置, token=config, 已启用\n```\n\n说明 QQ Bot 渠道已经被配置并启用了。\n\n> 如果你更熟悉手动改配置文件，也可以直接编辑 `~/.openclaw/openclaw.json`，在 `channels` 里加上 `qqbot` 的配置块，不过用 `channels add` 命令要省心很多。\n\n## 四、重启 OpenClaw 网关让配置生效\n\n渠道和插件准备好之后，需要重启网关进程，让新的 qqbot 渠道真正生效。\n\n我这里的重启命令是：\n\n```bash\ncd /root/clawd\nopenclaw-cn gateway restart\n```\n\n如果你是前台跑的 `openclaw-cn gateway`，也可以 Ctrl + C 停掉再重新启动一次。\n\n## 五、在 QQ 里把机器人拉进来测试\n\n1. 回到 QQ 机器人管理端，在沙箱/调试页面里，找到「添加成员」旁边的二维码。\n2. 用手机 QQ 扫码，把机器人加到自己的聊天列表或者某个 QQ 群里。\n3. 在 QQ 里给机器人发一句：\n\n   ```text\n   你好\n   ```\n\n4. 如果一切正常：\n   - 服务器日志里会看到 qqbot 收到这条消息；\n   - OpenClaw 会转发给当前配置的大脑（比如我现在这个会话）；\n   - 机器人会在 QQ 里回你一条正常的文本回复。\n\n到这一步，就说明「OpenClaw ↔ qqbot ↔ QQ」整条链路已经打通了。\n\n## 六、可选：定制 QQ 侧的人设 / 系统提示词\n\n默认情况下，qqbot 渠道会把 QQ 用户的消息转发给 OpenClaw 的主会话，用的是网关里配置的系统提示词。\n\n如果想给 QQ 单独定制一个“人格”，可以在 `qqbot` 渠道配置里加上 `systemPrompt` 字段，例如：\n\n```json\n{\n  \"channels\": {\n    \"qqbot\": {\n      \"enabled\": true,\n      \"appId\": \"你的AppID\",\n      \"clientSecret\": \"你的AppSecret\",\n      \"systemPrompt\": \"你是我的 QQ 机器人助手，回答要尽量简短、口语化。\"\n    }\n  }\n}\n```\n\n修改完配置之后，再重启一次网关即可生效。\n\n## 七、踩坑 & 小记\n\n- **IP 白名单一定要填服务器的公网 IP**，不是本地电脑的 IP，否则 qqbot 无法正常访问 QQ 接口。\n- 插件安装后如果发现渠道列表里没有 QQ Bot，优先检查：\n  - `plugins install` 是否报错；\n  - `channels add` 命令是否用对 token 格式 `AppID:AppSecret`。\n- OpenClaw 提示 `Config was last written by a newer Clawdbot` 可以先暂时忽略，只是配置文件由更新版本写入过的提醒，不影响 qqbot 正常使用。\n\n这次把 QQ 接入 OpenClaw 的过程基本跑通了，后面如果再折腾更多 QQ 相关自动化（比如群管、固定指令、联动其他服务），再另开一篇继续记折腾过程。\n\n","source":"_posts/OpenClaw-QQBot-Integration.md","raw":"---\ntitle: 将 OpenClaw 接入 QQ 机器人的完整实战记录\ndate: 2026-02-03 19:20:00\ncategories:\n  - 服务器\ntags:\n  - openclaw\n  - 第三方服务\n  - 瞎鼓捣\n  - 服务器\n---\n\n> 这篇是把「将 QQ 接入 OpenClaw」的全过程做一个完整记录，方便以后我自己/别人照着抄。\n\n## 前提条件\n\n- 一台可以长期在线的服务器（我这里是雨云的洛杉矶节点，Ubuntu Server 22.04）\n- OpenClaw 已经在服务器上跑起来，采用的是 **本机 `openclaw-cn` 方式**，而不是 Docker\n- 已有一个可用的 QQ 号，并可以在 QQ 开放平台创建机器人\n\n## 一、获取 QQ 机器人凭证 & 配置 IP 白名单\n\n1. 打开 QQ 开放平台：<https://q.qq.com/qqbot/#/home>\n2. 创建一个「机器人」应用（注意不是小程序/游戏）。\n3. 在「开发管理」里拿到：\n   - `AppID`\n   - `AppSecret`\n4. 在机器人配置里找到 **IP 白名单**，填入当前服务器的公网 IP。\n\n公网 IP 可以在服务器上用一条命令查出来，例如：\n\n```bash\ncurl https://myip.ipip.net\n```\n\n我这台机器返回的是：\n\n```text\n当前 IP：<你的服务器公网 IP>\n```\n\n于是就在 QQ 机器人管理后台的 IP 白名单里填了 `<你的服务器公网 IP>`。\n\n## 二、在服务器上安装 qqbot 插件\n\nOpenClaw 支持通过插件的方式接入各种渠道，QQ 对应的是社区插件 `sliverp/qqbot`。\n\n我的 OpenClaw 工作目录是 `/root/clawd`，在服务器上执行：\n\n```bash\ncd /root/clawd\n\n# 第一次使用时拉取 qqbot 插件仓库\ngit clone https://github.com/sliverp/qqbot.git\n\n# 通过 openclaw-cli 安装插件\nopenclaw-cn plugins install /root/clawd/qqbot/.\n```\n\n安装成功后日志里会出现类似：\n\n```text\nInstalling to /root/.openclaw/extensions/qqbot…\nInstalling plugin dependencies…\nInstalled plugin: qqbot\nRestart the gateway to load plugins.\n```\n\n## 三、在 OpenClaw 里添加 QQ Bot 渠道\n\n插件装好只是「有能力」接 qqbot，还需要在 OpenClaw 的渠道配置里，把 QQ 机器人账号接上来。\n\n我选择了最简单的方式：直接用命令行添加渠道，把 `AppID` 和 `AppSecret` 拼成一个 token。\n\n命令格式：\n\n```bash\nopenclaw-cn channels add --channel qqbot --token \"AppID:AppSecret\"\n```\n\n在这台服务器上的实际命令是：\n\n```bash\nopenclaw-cn channels add --channel qqbot --token \"102840004:LctBTm5Pk5RnAXvJi7XyPrJmFjDiDjGn\"\n```\n\n执行完后，用下面的命令检查渠道状态：\n\n```bash\nopenclaw-cn channels list\n```\n\n预期输出中应该能看到类似：\n\n```text\n聊天通道：\n- Feishu default: 已配置, token=config, 已启用\n- QQ Bot default: 已配置, token=config, 已启用\n```\n\n说明 QQ Bot 渠道已经被配置并启用了。\n\n> 如果你更熟悉手动改配置文件，也可以直接编辑 `~/.openclaw/openclaw.json`，在 `channels` 里加上 `qqbot` 的配置块，不过用 `channels add` 命令要省心很多。\n\n## 四、重启 OpenClaw 网关让配置生效\n\n渠道和插件准备好之后，需要重启网关进程，让新的 qqbot 渠道真正生效。\n\n我这里的重启命令是：\n\n```bash\ncd /root/clawd\nopenclaw-cn gateway restart\n```\n\n如果你是前台跑的 `openclaw-cn gateway`，也可以 Ctrl + C 停掉再重新启动一次。\n\n## 五、在 QQ 里把机器人拉进来测试\n\n1. 回到 QQ 机器人管理端，在沙箱/调试页面里，找到「添加成员」旁边的二维码。\n2. 用手机 QQ 扫码，把机器人加到自己的聊天列表或者某个 QQ 群里。\n3. 在 QQ 里给机器人发一句：\n\n   ```text\n   你好\n   ```\n\n4. 如果一切正常：\n   - 服务器日志里会看到 qqbot 收到这条消息；\n   - OpenClaw 会转发给当前配置的大脑（比如我现在这个会话）；\n   - 机器人会在 QQ 里回你一条正常的文本回复。\n\n到这一步，就说明「OpenClaw ↔ qqbot ↔ QQ」整条链路已经打通了。\n\n## 六、可选：定制 QQ 侧的人设 / 系统提示词\n\n默认情况下，qqbot 渠道会把 QQ 用户的消息转发给 OpenClaw 的主会话，用的是网关里配置的系统提示词。\n\n如果想给 QQ 单独定制一个“人格”，可以在 `qqbot` 渠道配置里加上 `systemPrompt` 字段，例如：\n\n```json\n{\n  \"channels\": {\n    \"qqbot\": {\n      \"enabled\": true,\n      \"appId\": \"你的AppID\",\n      \"clientSecret\": \"你的AppSecret\",\n      \"systemPrompt\": \"你是我的 QQ 机器人助手，回答要尽量简短、口语化。\"\n    }\n  }\n}\n```\n\n修改完配置之后，再重启一次网关即可生效。\n\n## 七、踩坑 & 小记\n\n- **IP 白名单一定要填服务器的公网 IP**，不是本地电脑的 IP，否则 qqbot 无法正常访问 QQ 接口。\n- 插件安装后如果发现渠道列表里没有 QQ Bot，优先检查：\n  - `plugins install` 是否报错；\n  - `channels add` 命令是否用对 token 格式 `AppID:AppSecret`。\n- OpenClaw 提示 `Config was last written by a newer Clawdbot` 可以先暂时忽略，只是配置文件由更新版本写入过的提醒，不影响 qqbot 正常使用。\n\n这次把 QQ 接入 OpenClaw 的过程基本跑通了，后面如果再折腾更多 QQ 相关自动化（比如群管、固定指令、联动其他服务），再另开一篇继续记折腾过程。\n\n","slug":"OpenClaw-QQBot-Integration","published":1,"updated":"2026-02-03T11:22:16.140Z","comments":1,"layout":"post","photos":[],"_id":"cuidp0bPflksFZe37R4VInuJv","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这篇是把「将 QQ 接入 OpenClaw」的全过程做一个完整记录，方便以后我自己&#x2F;别人照着抄。</p></blockquote>\n<h2 id=\"前提条件\"><a href=\"#前提条件\" class=\"headerlink\" title=\"前提条件\"></a>前提条件</h2><ul>\n<li>一台可以长期在线的服务器（我这里是雨云的洛杉矶节点，Ubuntu Server 22.04）</li>\n<li>OpenClaw 已经在服务器上跑起来，采用的是 <strong>本机 <code>openclaw-cn</code> 方式</strong>，而不是 Docker</li>\n<li>已有一个可用的 QQ 号，并可以在 QQ 开放平台创建机器人</li>\n</ul>\n<h2 id=\"一、获取-QQ-机器人凭证-配置-IP-白名单\"><a href=\"#一、获取-QQ-机器人凭证-配置-IP-白名单\" class=\"headerlink\" title=\"一、获取 QQ 机器人凭证 &amp; 配置 IP 白名单\"></a>一、获取 QQ 机器人凭证 &amp; 配置 IP 白名单</h2><ol>\n<li>打开 QQ 开放平台：<a href=\"https://q.qq.com/qqbot/#/home\">https://q.qq.com/qqbot/#/home</a></li>\n<li>创建一个「机器人」应用（注意不是小程序&#x2F;游戏）。</li>\n<li>在「开发管理」里拿到：<ul>\n<li><code>AppID</code></li>\n<li><code>AppSecret</code></li>\n</ul>\n</li>\n<li>在机器人配置里找到 <strong>IP 白名单</strong>，填入当前服务器的公网 IP。</li>\n</ol>\n<p>公网 IP 可以在服务器上用一条命令查出来，例如：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://myip.ipip.net</span><br></pre></td></tr></table></figure>\n\n<p>我这台机器返回的是：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前 IP：&lt;你的服务器公网 IP&gt;</span><br></pre></td></tr></table></figure>\n\n<p>于是就在 QQ 机器人管理后台的 IP 白名单里填了 <code>&lt;你的服务器公网 IP&gt;</code>。</p>\n<h2 id=\"二、在服务器上安装-qqbot-插件\"><a href=\"#二、在服务器上安装-qqbot-插件\" class=\"headerlink\" title=\"二、在服务器上安装 qqbot 插件\"></a>二、在服务器上安装 qqbot 插件</h2><p>OpenClaw 支持通过插件的方式接入各种渠道，QQ 对应的是社区插件 <code>sliverp/qqbot</code>。</p>\n<p>我的 OpenClaw 工作目录是 <code>/root/clawd</code>，在服务器上执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /root/clawd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 第一次使用时拉取 qqbot 插件仓库</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/sliverp/qqbot.git</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 通过 openclaw-cli 安装插件</span></span><br><span class=\"line\">openclaw-cn plugins install /root/clawd/qqbot/.</span><br></pre></td></tr></table></figure>\n\n<p>安装成功后日志里会出现类似：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Installing to /root/.openclaw/extensions/qqbot…</span><br><span class=\"line\">Installing plugin dependencies…</span><br><span class=\"line\">Installed plugin: qqbot</span><br><span class=\"line\">Restart the gateway to load plugins.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三、在-OpenClaw-里添加-QQ-Bot-渠道\"><a href=\"#三、在-OpenClaw-里添加-QQ-Bot-渠道\" class=\"headerlink\" title=\"三、在 OpenClaw 里添加 QQ Bot 渠道\"></a>三、在 OpenClaw 里添加 QQ Bot 渠道</h2><p>插件装好只是「有能力」接 qqbot，还需要在 OpenClaw 的渠道配置里，把 QQ 机器人账号接上来。</p>\n<p>我选择了最简单的方式：直接用命令行添加渠道，把 <code>AppID</code> 和 <code>AppSecret</code> 拼成一个 token。</p>\n<p>命令格式：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openclaw-cn channels add --channel qqbot --token <span class=\"string\">&quot;AppID:AppSecret&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>在这台服务器上的实际命令是：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openclaw-cn channels add --channel qqbot --token <span class=\"string\">&quot;102840004:LctBTm5Pk5RnAXvJi7XyPrJmFjDiDjGn&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>执行完后，用下面的命令检查渠道状态：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openclaw-cn channels list</span><br></pre></td></tr></table></figure>\n\n<p>预期输出中应该能看到类似：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">聊天通道：</span><br><span class=\"line\">- Feishu default: 已配置, token=config, 已启用</span><br><span class=\"line\">- QQ Bot default: 已配置, token=config, 已启用</span><br></pre></td></tr></table></figure>\n\n<p>说明 QQ Bot 渠道已经被配置并启用了。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>如果你更熟悉手动改配置文件，也可以直接编辑 <code>~/.openclaw/openclaw.json</code>，在 <code>channels</code> 里加上 <code>qqbot</code> 的配置块，不过用 <code>channels add</code> 命令要省心很多。</p></blockquote>\n<h2 id=\"四、重启-OpenClaw-网关让配置生效\"><a href=\"#四、重启-OpenClaw-网关让配置生效\" class=\"headerlink\" title=\"四、重启 OpenClaw 网关让配置生效\"></a>四、重启 OpenClaw 网关让配置生效</h2><p>渠道和插件准备好之后，需要重启网关进程，让新的 qqbot 渠道真正生效。</p>\n<p>我这里的重启命令是：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /root/clawd</span><br><span class=\"line\">openclaw-cn gateway restart</span><br></pre></td></tr></table></figure>\n\n<p>如果你是前台跑的 <code>openclaw-cn gateway</code>，也可以 Ctrl + C 停掉再重新启动一次。</p>\n<h2 id=\"五、在-QQ-里把机器人拉进来测试\"><a href=\"#五、在-QQ-里把机器人拉进来测试\" class=\"headerlink\" title=\"五、在 QQ 里把机器人拉进来测试\"></a>五、在 QQ 里把机器人拉进来测试</h2><ol>\n<li><p>回到 QQ 机器人管理端，在沙箱&#x2F;调试页面里，找到「添加成员」旁边的二维码。</p>\n</li>\n<li><p>用手机 QQ 扫码，把机器人加到自己的聊天列表或者某个 QQ 群里。</p>\n</li>\n<li><p>在 QQ 里给机器人发一句：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">你好</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>如果一切正常：</p>\n<ul>\n<li>服务器日志里会看到 qqbot 收到这条消息；</li>\n<li>OpenClaw 会转发给当前配置的大脑（比如我现在这个会话）；</li>\n<li>机器人会在 QQ 里回你一条正常的文本回复。</li>\n</ul>\n</li>\n</ol>\n<p>到这一步，就说明「OpenClaw ↔ qqbot ↔ QQ」整条链路已经打通了。</p>\n<h2 id=\"六、可选：定制-QQ-侧的人设-系统提示词\"><a href=\"#六、可选：定制-QQ-侧的人设-系统提示词\" class=\"headerlink\" title=\"六、可选：定制 QQ 侧的人设 &#x2F; 系统提示词\"></a>六、可选：定制 QQ 侧的人设 &#x2F; 系统提示词</h2><p>默认情况下，qqbot 渠道会把 QQ 用户的消息转发给 OpenClaw 的主会话，用的是网关里配置的系统提示词。</p>\n<p>如果想给 QQ 单独定制一个“人格”，可以在 <code>qqbot</code> 渠道配置里加上 <code>systemPrompt</code> 字段，例如：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;channels&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;qqbot&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;enabled&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;appId&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;你的AppID&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;clientSecret&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;你的AppSecret&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;systemPrompt&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;你是我的 QQ 机器人助手，回答要尽量简短、口语化。&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>修改完配置之后，再重启一次网关即可生效。</p>\n<h2 id=\"七、踩坑-小记\"><a href=\"#七、踩坑-小记\" class=\"headerlink\" title=\"七、踩坑 &amp; 小记\"></a>七、踩坑 &amp; 小记</h2><ul>\n<li><strong>IP 白名单一定要填服务器的公网 IP</strong>，不是本地电脑的 IP，否则 qqbot 无法正常访问 QQ 接口。</li>\n<li>插件安装后如果发现渠道列表里没有 QQ Bot，优先检查：<ul>\n<li><code>plugins install</code> 是否报错；</li>\n<li><code>channels add</code> 命令是否用对 token 格式 <code>AppID:AppSecret</code>。</li>\n</ul>\n</li>\n<li>OpenClaw 提示 <code>Config was last written by a newer Clawdbot</code> 可以先暂时忽略，只是配置文件由更新版本写入过的提醒，不影响 qqbot 正常使用。</li>\n</ul>\n<p>这次把 QQ 接入 OpenClaw 的过程基本跑通了，后面如果再折腾更多 QQ 相关自动化（比如群管、固定指令、联动其他服务），再另开一篇继续记折腾过程。</p>\n","excerpt":"","more":"<blockquote>\n<p>这篇是把「将 QQ 接入 OpenClaw」的全过程做一个完整记录，方便以后我自己&#x2F;别人照着抄。</p>\n</blockquote>\n<h2 id=\"前提条件\"><a href=\"#前提条件\" class=\"headerlink\" title=\"前提条件\"></a>前提条件</h2><ul>\n<li>一台可以长期在线的服务器（我这里是雨云的洛杉矶节点，Ubuntu Server 22.04）</li>\n<li>OpenClaw 已经在服务器上跑起来，采用的是 <strong>本机 <code>openclaw-cn</code> 方式</strong>，而不是 Docker</li>\n<li>已有一个可用的 QQ 号，并可以在 QQ 开放平台创建机器人</li>\n</ul>\n<h2 id=\"一、获取-QQ-机器人凭证-配置-IP-白名单\"><a href=\"#一、获取-QQ-机器人凭证-配置-IP-白名单\" class=\"headerlink\" title=\"一、获取 QQ 机器人凭证 &amp; 配置 IP 白名单\"></a>一、获取 QQ 机器人凭证 &amp; 配置 IP 白名单</h2><ol>\n<li>打开 QQ 开放平台：<a href=\"https://q.qq.com/qqbot/#/home\">https://q.qq.com/qqbot/#/home</a></li>\n<li>创建一个「机器人」应用（注意不是小程序&#x2F;游戏）。</li>\n<li>在「开发管理」里拿到：<ul>\n<li><code>AppID</code></li>\n<li><code>AppSecret</code></li>\n</ul>\n</li>\n<li>在机器人配置里找到 <strong>IP 白名单</strong>，填入当前服务器的公网 IP。</li>\n</ol>\n<p>公网 IP 可以在服务器上用一条命令查出来，例如：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://myip.ipip.net</span><br></pre></td></tr></table></figure>\n\n<p>我这台机器返回的是：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前 IP：&lt;你的服务器公网 IP&gt;</span><br></pre></td></tr></table></figure>\n\n<p>于是就在 QQ 机器人管理后台的 IP 白名单里填了 <code>&lt;你的服务器公网 IP&gt;</code>。</p>\n<h2 id=\"二、在服务器上安装-qqbot-插件\"><a href=\"#二、在服务器上安装-qqbot-插件\" class=\"headerlink\" title=\"二、在服务器上安装 qqbot 插件\"></a>二、在服务器上安装 qqbot 插件</h2><p>OpenClaw 支持通过插件的方式接入各种渠道，QQ 对应的是社区插件 <code>sliverp/qqbot</code>。</p>\n<p>我的 OpenClaw 工作目录是 <code>/root/clawd</code>，在服务器上执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /root/clawd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 第一次使用时拉取 qqbot 插件仓库</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/sliverp/qqbot.git</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 通过 openclaw-cli 安装插件</span></span><br><span class=\"line\">openclaw-cn plugins install /root/clawd/qqbot/.</span><br></pre></td></tr></table></figure>\n\n<p>安装成功后日志里会出现类似：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Installing to /root/.openclaw/extensions/qqbot…</span><br><span class=\"line\">Installing plugin dependencies…</span><br><span class=\"line\">Installed plugin: qqbot</span><br><span class=\"line\">Restart the gateway to load plugins.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三、在-OpenClaw-里添加-QQ-Bot-渠道\"><a href=\"#三、在-OpenClaw-里添加-QQ-Bot-渠道\" class=\"headerlink\" title=\"三、在 OpenClaw 里添加 QQ Bot 渠道\"></a>三、在 OpenClaw 里添加 QQ Bot 渠道</h2><p>插件装好只是「有能力」接 qqbot，还需要在 OpenClaw 的渠道配置里，把 QQ 机器人账号接上来。</p>\n<p>我选择了最简单的方式：直接用命令行添加渠道，把 <code>AppID</code> 和 <code>AppSecret</code> 拼成一个 token。</p>\n<p>命令格式：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openclaw-cn channels add --channel qqbot --token <span class=\"string\">&quot;AppID:AppSecret&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>在这台服务器上的实际命令是：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openclaw-cn channels add --channel qqbot --token <span class=\"string\">&quot;102840004:LctBTm5Pk5RnAXvJi7XyPrJmFjDiDjGn&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>执行完后，用下面的命令检查渠道状态：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openclaw-cn channels list</span><br></pre></td></tr></table></figure>\n\n<p>预期输出中应该能看到类似：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">聊天通道：</span><br><span class=\"line\">- Feishu default: 已配置, token=config, 已启用</span><br><span class=\"line\">- QQ Bot default: 已配置, token=config, 已启用</span><br></pre></td></tr></table></figure>\n\n<p>说明 QQ Bot 渠道已经被配置并启用了。</p>\n<blockquote>\n<p>如果你更熟悉手动改配置文件，也可以直接编辑 <code>~/.openclaw/openclaw.json</code>，在 <code>channels</code> 里加上 <code>qqbot</code> 的配置块，不过用 <code>channels add</code> 命令要省心很多。</p>\n</blockquote>\n<h2 id=\"四、重启-OpenClaw-网关让配置生效\"><a href=\"#四、重启-OpenClaw-网关让配置生效\" class=\"headerlink\" title=\"四、重启 OpenClaw 网关让配置生效\"></a>四、重启 OpenClaw 网关让配置生效</h2><p>渠道和插件准备好之后，需要重启网关进程，让新的 qqbot 渠道真正生效。</p>\n<p>我这里的重启命令是：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /root/clawd</span><br><span class=\"line\">openclaw-cn gateway restart</span><br></pre></td></tr></table></figure>\n\n<p>如果你是前台跑的 <code>openclaw-cn gateway</code>，也可以 Ctrl + C 停掉再重新启动一次。</p>\n<h2 id=\"五、在-QQ-里把机器人拉进来测试\"><a href=\"#五、在-QQ-里把机器人拉进来测试\" class=\"headerlink\" title=\"五、在 QQ 里把机器人拉进来测试\"></a>五、在 QQ 里把机器人拉进来测试</h2><ol>\n<li><p>回到 QQ 机器人管理端，在沙箱&#x2F;调试页面里，找到「添加成员」旁边的二维码。</p>\n</li>\n<li><p>用手机 QQ 扫码，把机器人加到自己的聊天列表或者某个 QQ 群里。</p>\n</li>\n<li><p>在 QQ 里给机器人发一句：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">你好</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>如果一切正常：</p>\n<ul>\n<li>服务器日志里会看到 qqbot 收到这条消息；</li>\n<li>OpenClaw 会转发给当前配置的大脑（比如我现在这个会话）；</li>\n<li>机器人会在 QQ 里回你一条正常的文本回复。</li>\n</ul>\n</li>\n</ol>\n<p>到这一步，就说明「OpenClaw ↔ qqbot ↔ QQ」整条链路已经打通了。</p>\n<h2 id=\"六、可选：定制-QQ-侧的人设-系统提示词\"><a href=\"#六、可选：定制-QQ-侧的人设-系统提示词\" class=\"headerlink\" title=\"六、可选：定制 QQ 侧的人设 &#x2F; 系统提示词\"></a>六、可选：定制 QQ 侧的人设 &#x2F; 系统提示词</h2><p>默认情况下，qqbot 渠道会把 QQ 用户的消息转发给 OpenClaw 的主会话，用的是网关里配置的系统提示词。</p>\n<p>如果想给 QQ 单独定制一个“人格”，可以在 <code>qqbot</code> 渠道配置里加上 <code>systemPrompt</code> 字段，例如：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;channels&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;qqbot&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;enabled&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;appId&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;你的AppID&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;clientSecret&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;你的AppSecret&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;systemPrompt&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;你是我的 QQ 机器人助手，回答要尽量简短、口语化。&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>修改完配置之后，再重启一次网关即可生效。</p>\n<h2 id=\"七、踩坑-小记\"><a href=\"#七、踩坑-小记\" class=\"headerlink\" title=\"七、踩坑 &amp; 小记\"></a>七、踩坑 &amp; 小记</h2><ul>\n<li><strong>IP 白名单一定要填服务器的公网 IP</strong>，不是本地电脑的 IP，否则 qqbot 无法正常访问 QQ 接口。</li>\n<li>插件安装后如果发现渠道列表里没有 QQ Bot，优先检查：<ul>\n<li><code>plugins install</code> 是否报错；</li>\n<li><code>channels add</code> 命令是否用对 token 格式 <code>AppID:AppSecret</code>。</li>\n</ul>\n</li>\n<li>OpenClaw 提示 <code>Config was last written by a newer Clawdbot</code> 可以先暂时忽略，只是配置文件由更新版本写入过的提醒，不影响 qqbot 正常使用。</li>\n</ul>\n<p>这次把 QQ 接入 OpenClaw 的过程基本跑通了，后面如果再折腾更多 QQ 相关自动化（比如群管、固定指令、联动其他服务），再另开一篇继续记折腾过程。</p>\n"},{"title":"nvm 不同 Node 版本使用不同 registry 的配置实战","date":"2026-02-04T02:50:00.000Z","_content":"\n# nvm 不同版本配置不同 registry\n\n## 前言\n\n我们在开发的情况下因为项目的历史原因，需要使用不同版本的 node。而在使用 AI 工具的时候又需要使用新版本（20+）的 node，会导致因为配置了公司源导致更新失败，每次都手动加 `--registry=` 又很麻烦，所以研究了下怎么一劳永逸，直接修改配置解决。\n\n## 配置步骤\n\n```sh\n# 给不同版本写各自 global\n\n# v20 使用公共源\nnvm use 20\nnpm config set registry https://registry.npmjs.org/ --location=global\n\n# 其他版本使用公司源（旧 npm 用 --global）\nnvm use 16\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n\nnvm use 14\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n\nnvm use 12\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n\nnvm use 8\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n```\n\n## 验证\n\n```sh\nfor v in 20 16 14 12 8; do\n  nvm use $v >/dev/null\n  printf \"v%s -> %s\\n\" \"$v\" \"$(npm config get registry)\"\ndone\n```\n\n<br/>\n\n## 可能碰到的问题\n\n### 表现\n\n执行验证脚本打印出来的依旧还是全部都是公司源，好像后面设置的给前面的覆盖掉了。\n\n### 原因\n\n`~/.npmrc`（user/project）里有 `registry=`，优先级高于每个版本的 global，导致所有版本被同一个源覆盖。\n\n---\n\n## 应对方式\n\n清掉 user/project 的 registry：\n\n```sh\n# 查看 ~/.npmrc\nnl -ba ~/.npmrc\n\n# 删除 registry 行\nsed -i '' '/^registry=/d' ~/.npmrc\n```\n\n再执行上述的配置流程即可。\n","source":"_posts/nvm-multi-registry-config.md","raw":"---\n title: nvm 不同 Node 版本使用不同 registry 的配置实战\n date: 2026-02-04 10:50:00\n categories:\n   - 前端相关\n tags:\n   - 环境配置\n   - nvm\n   - node版本\n   - 前端配置\n   - 工作积累\n---\n\n# nvm 不同版本配置不同 registry\n\n## 前言\n\n我们在开发的情况下因为项目的历史原因，需要使用不同版本的 node。而在使用 AI 工具的时候又需要使用新版本（20+）的 node，会导致因为配置了公司源导致更新失败，每次都手动加 `--registry=` 又很麻烦，所以研究了下怎么一劳永逸，直接修改配置解决。\n\n## 配置步骤\n\n```sh\n# 给不同版本写各自 global\n\n# v20 使用公共源\nnvm use 20\nnpm config set registry https://registry.npmjs.org/ --location=global\n\n# 其他版本使用公司源（旧 npm 用 --global）\nnvm use 16\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n\nnvm use 14\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n\nnvm use 12\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n\nnvm use 8\nnpm config set registry https://art.haizhi.com/artifactory/api/npm/npm/ --global\n```\n\n## 验证\n\n```sh\nfor v in 20 16 14 12 8; do\n  nvm use $v >/dev/null\n  printf \"v%s -> %s\\n\" \"$v\" \"$(npm config get registry)\"\ndone\n```\n\n<br/>\n\n## 可能碰到的问题\n\n### 表现\n\n执行验证脚本打印出来的依旧还是全部都是公司源，好像后面设置的给前面的覆盖掉了。\n\n### 原因\n\n`~/.npmrc`（user/project）里有 `registry=`，优先级高于每个版本的 global，导致所有版本被同一个源覆盖。\n\n---\n\n## 应对方式\n\n清掉 user/project 的 registry：\n\n```sh\n# 查看 ~/.npmrc\nnl -ba ~/.npmrc\n\n# 删除 registry 行\nsed -i '' '/^registry=/d' ~/.npmrc\n```\n\n再执行上述的配置流程即可。\n","slug":"nvm-multi-registry-config","published":1,"updated":"2026-02-04T02:46:09.623Z","comments":1,"layout":"post","photos":[],"_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","content":"<h1 id=\"nvm-不同版本配置不同-registry\"><a href=\"#nvm-不同版本配置不同-registry\" class=\"headerlink\" title=\"nvm 不同版本配置不同 registry\"></a>nvm 不同版本配置不同 registry</h1><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>我们在开发的情况下因为项目的历史原因，需要使用不同版本的 node。而在使用 AI 工具的时候又需要使用新版本（20+）的 node，会导致因为配置了公司源导致更新失败，每次都手动加 <code>--registry=</code> 又很麻烦，所以研究了下怎么一劳永逸，直接修改配置解决。</p>\n<h2 id=\"配置步骤\"><a href=\"#配置步骤\" class=\"headerlink\" title=\"配置步骤\"></a>配置步骤</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 给不同版本写各自 global</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># v20 使用公共源</span></span><br><span class=\"line\">nvm use 20</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://registry.npmjs.org/ --location=global</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 其他版本使用公司源（旧 npm 用 --global）</span></span><br><span class=\"line\">nvm use 16</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br><span class=\"line\"></span><br><span class=\"line\">nvm use 14</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br><span class=\"line\"></span><br><span class=\"line\">nvm use 12</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br><span class=\"line\"></span><br><span class=\"line\">nvm use 8</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> v <span class=\"keyword\">in</span> 20 16 14 12 8; <span class=\"keyword\">do</span></span><br><span class=\"line\">  nvm use <span class=\"variable\">$v</span> &gt;/dev/null</span><br><span class=\"line\">  <span class=\"built_in\">printf</span> <span class=\"string\">&quot;v%s -&gt; %s\\n&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$v</span>&quot;</span> <span class=\"string\">&quot;<span class=\"subst\">$(npm config get registry)</span>&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<br/>\n\n<h2 id=\"可能碰到的问题\"><a href=\"#可能碰到的问题\" class=\"headerlink\" title=\"可能碰到的问题\"></a>可能碰到的问题</h2><h3 id=\"表现\"><a href=\"#表现\" class=\"headerlink\" title=\"表现\"></a>表现</h3><p>执行验证脚本打印出来的依旧还是全部都是公司源，好像后面设置的给前面的覆盖掉了。</p>\n<h3 id=\"原因\"><a href=\"#原因\" class=\"headerlink\" title=\"原因\"></a>原因</h3><p><code>~/.npmrc</code>（user&#x2F;project）里有 <code>registry=</code>，优先级高于每个版本的 global，导致所有版本被同一个源覆盖。</p>\n<hr>\n<h2 id=\"应对方式\"><a href=\"#应对方式\" class=\"headerlink\" title=\"应对方式\"></a>应对方式</h2><p>清掉 user&#x2F;project 的 registry：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看 ~/.npmrc</span></span><br><span class=\"line\"><span class=\"built_in\">nl</span> -ba ~/.npmrc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除 registry 行</span></span><br><span class=\"line\">sed -i <span class=\"string\">&#x27;&#x27;</span> <span class=\"string\">&#x27;/^registry=/d&#x27;</span> ~/.npmrc</span><br></pre></td></tr></table></figure>\n\n<p>再执行上述的配置流程即可。</p>\n","excerpt":"","more":"<h1 id=\"nvm-不同版本配置不同-registry\"><a href=\"#nvm-不同版本配置不同-registry\" class=\"headerlink\" title=\"nvm 不同版本配置不同 registry\"></a>nvm 不同版本配置不同 registry</h1><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>我们在开发的情况下因为项目的历史原因，需要使用不同版本的 node。而在使用 AI 工具的时候又需要使用新版本（20+）的 node，会导致因为配置了公司源导致更新失败，每次都手动加 <code>--registry=</code> 又很麻烦，所以研究了下怎么一劳永逸，直接修改配置解决。</p>\n<h2 id=\"配置步骤\"><a href=\"#配置步骤\" class=\"headerlink\" title=\"配置步骤\"></a>配置步骤</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 给不同版本写各自 global</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># v20 使用公共源</span></span><br><span class=\"line\">nvm use 20</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://registry.npmjs.org/ --location=global</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 其他版本使用公司源（旧 npm 用 --global）</span></span><br><span class=\"line\">nvm use 16</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br><span class=\"line\"></span><br><span class=\"line\">nvm use 14</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br><span class=\"line\"></span><br><span class=\"line\">nvm use 12</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br><span class=\"line\"></span><br><span class=\"line\">nvm use 8</span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://art.haizhi.com/artifactory/api/npm/npm/ --global</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> v <span class=\"keyword\">in</span> 20 16 14 12 8; <span class=\"keyword\">do</span></span><br><span class=\"line\">  nvm use <span class=\"variable\">$v</span> &gt;/dev/null</span><br><span class=\"line\">  <span class=\"built_in\">printf</span> <span class=\"string\">&quot;v%s -&gt; %s\\n&quot;</span> <span class=\"string\">&quot;<span class=\"variable\">$v</span>&quot;</span> <span class=\"string\">&quot;<span class=\"subst\">$(npm config get registry)</span>&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<br/>\n\n<h2 id=\"可能碰到的问题\"><a href=\"#可能碰到的问题\" class=\"headerlink\" title=\"可能碰到的问题\"></a>可能碰到的问题</h2><h3 id=\"表现\"><a href=\"#表现\" class=\"headerlink\" title=\"表现\"></a>表现</h3><p>执行验证脚本打印出来的依旧还是全部都是公司源，好像后面设置的给前面的覆盖掉了。</p>\n<h3 id=\"原因\"><a href=\"#原因\" class=\"headerlink\" title=\"原因\"></a>原因</h3><p><code>~/.npmrc</code>（user&#x2F;project）里有 <code>registry=</code>，优先级高于每个版本的 global，导致所有版本被同一个源覆盖。</p>\n<hr>\n<h2 id=\"应对方式\"><a href=\"#应对方式\" class=\"headerlink\" title=\"应对方式\"></a>应对方式</h2><p>清掉 user&#x2F;project 的 registry：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看 ~/.npmrc</span></span><br><span class=\"line\"><span class=\"built_in\">nl</span> -ba ~/.npmrc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除 registry 行</span></span><br><span class=\"line\">sed -i <span class=\"string\">&#x27;&#x27;</span> <span class=\"string\">&#x27;/^registry=/d&#x27;</span> ~/.npmrc</span><br></pre></td></tr></table></figure>\n\n<p>再执行上述的配置流程即可。</p>\n"},{"title":"Home Assistant + OpenClaw","author":"blog-author","date":"2026-02-03T00:35:11.000Z","_content":"# 从 0 到 能说话控制洗衣机：Home Assistant + 美的美居 + OpenClaw 实战记录\n\n> 记录一下我在雨云服务器上从零搭建 Home Assistant，接入美的洗衣机，然后用 OpenClaw / Clawdbot 做到“说一句话就帮我跑桶自洁”的完整过程。  \n时间线大致是：**部署 HA → 配环境变量 → 安装集成 → 接入美的洗衣机 → 调通桶自洁程序 → 对话控制链路**。\n\n---\n\n## 一、环境与目标\n\n- 服务器：雨云 VPS\n- 系统：Ubuntu Server 22.04 LTS\n- 面板：1Panel\n- 目标：\n  - 在这台服务器上部署 Home Assistant\n  - 接入美的洗衣机（美的云 / Midea Auto Cloud）\n  - 在 OpenClaw / Clawdbot 中通过自然语言控制洗衣机（例如“帮我打开洗衣机，程序为桶自洁”）\n\n---\n\n## 二、部署 Home Assistant（2 月 2 日）\n\n### 2.1 部署方式选择\n\nHome Assistant 官方支持多种方式：\n\n- Home Assistant OS（整机镜像）\n- Home Assistant Container（Docker）\n- Home Assistant Core（Python venv）\n\n我的环境本身就有 1Panel 和 Docker，所以选择了 **Home Assistant Container**，方便运维和备份。\n\n### 2.2 Docker 启动 Home Assistant\n\n在服务器上执行（也可以用 1Panel 图形界面对照配置）：\n\n```sh\ndocker run -d \\\n  --name homeassistant \\\n  --restart=unless-stopped \\\n  -e TZ=Asia/Shanghai \\\n  -v /opt/homeassistant/config:/config \\\n  --net=host \\\n  ghcr.io/home-assistant/home-assistant:stable\n```\n\n关键点：\n\n- `--net=host`：方便 Home Assistant 使用 8123 端口和发现局域网设备  \n- `-v /opt/homeassistant/config:/config`：配置持久化到宿主机  \n- `TZ=Asia/Shanghai`：时区设置为国内时间\n\n部署后，浏览器访问：\n\n```text\nhttp://<服务器 IP>:8123\n```\n\n按 Web 引导完成 HA 的初始用户、密码及基础配置。\n\n---\n\n## 三、为 OpenClaw 准备 HA API 环境（2 月 2 日）\n\n为了让 Clawdbot 能通过 Home Assistant 的 API 控制设备，需要在 OpenClaw 的网关进程里配置两个环境变量：\n\n- `HA_URL`：Home Assistant 的访问地址\n- `HA_TOKEN`：Home Assistant 的长效访问令牌（Long-Lived Access Token）\n\n### 3.1 在 Home Assistant 创建 Long-Lived Token\n\n在 HA Web 界面中：\n\n1. 右上角点击头像 → “**个人资料**”\n2. 滚到页面最底部，找到 **长效访问令牌**\n3. 新建一个令牌（例如命名为 `openclaw-gateway`）\n4. 复制生成的 Token（只会显示一次）\n\n### 3.2 给 OpenClaw 网关注入环境变量\n\nOpenClaw 网关是一个 systemd 用户服务：`openclaw-gateway.service`。\n\n编辑 override：\n\n```sh\nsystemctl --user edit openclaw-gateway.service\n```\n\n在弹出的编辑器中增加：\n\n```ini\n[Service]\nEnvironment=HA_URL=http://127.0.0.1:8123\nEnvironment=HA_TOKEN=<从 HA 生成的 Long-Lived Token>\n```\n\n保存后执行：\n\n```sh\nsystemctl --user daemon-reload\nsystemctl --user restart openclaw-gateway.service\n```\n\n检查环境变量是否生效（例如通过 `ps e` 或日志）可以看到：\n\n```text\nHA_URL=http://127.0.0.1:8123\nHA_TOKEN=<same token>\n```\n\n到此，OpenClaw 内置的 `homeassistant` skill 已具备访问 HA API 的能力。\n\n---\n\n## 四、安装 Midea Auto Cloud 集成并接入美的洗衣机\n\n> 这一段是核心前置：让 Home Assistant 认识洗衣机。\n\n### 4.1 安装 HACS（如未安装）\n\nHACS 是 Home Assistant 的“第三方商店”，很多社区集成都通过它安装。\n\n简单步骤：\n\n1. SSH 到服务器，进入 HA 的配置目录（容器挂载点），比如：\n   ```sh\n   cd /opt/homeassistant/config\n   ```\n2. 一键安装脚本：\n   ```sh\n   wget -O - https://get.hacs.xyz | bash -\n   ```\n3. 重启 Home Assistant 容器：\n   ```sh\n   docker restart homeassistant\n   ```\n4. Web UI 中按照 HACS 文档完成初次配置。  \n成功后左侧菜单会出现 `HACS`。\n\n### 4.2 安装并配置 Midea Auto Cloud\n\n1. 在 HACS → **Integrations** 中搜索并安装 `Midea Auto Cloud` 集成\n2. 安装完成后重启 HA\n3. 进入：设置 → 设备与服务 → 添加集成  \n搜索 `Midea Auto Cloud`，按提示用美的 / MSmartHome / 美居账号登录绑定\n4. 完成后，到 **设备与实体列表** 中确认美的洗衣机已经以多个实体的形式出现\n\n到这里，洗衣机已经“出现在” Home Assistant 中了，接下来就只剩下找准实体 ID 和程序。\n\n---\n\n## 五、确认洗衣机实体与可用程序（2 月 3 日）\n\n在这一步，需要从 HA 的实体列表中找到与洗衣机有关的几类实体。\n\n### 5.1 关键实体 ID\n\n最终确认的几个关键实体如下（你的设备 ID 可能不同）：\n\n- 电源开关：`switch.208907217759387_power`  \n- 启停控制：`switch.208907217759387_control_status`  \n- 程序选择：`select.208907217759387_program`  \n- 运行状态：`sensor.208907217759387_running_status`\n\n可以通过 HA 的开发者工具 → 状态，或者 API：\n\n```sh\ncurl -s \"$HA_URL/api/states\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" | jq '.[] | select(.entity_id | contains(\"208907217759387\"))'\n```\n\n来过滤只和洗衣机相关的实体。\n\n### 5.2 程序列表与「桶自洁」对应关系\n\n`select.208907217759387_program` 的属性中有一个 `options` 列表，展示所有支持的程序，例如（节选）：\n\n```json\n\"options\": [\n  \"cotton\",\n  \"eco\",\n  \"fast_wash\",\n  \"mixed_wash\",\n  \"wool\",\n  \"ssp\",\n  ...\n  \"tube_clean_all\",\n  ...\n]\n```\n\n通过实际操作验证：\n\n- 在美的 App / HA 前端选择 UI 上显示的「筒自洁」，  \n观察 `select.208907217759387_program` 的状态，发现它变成了：`ssp`  \n- `options` 列表里还有一个 `tube_clean_all`，对应的是“更彻底”的桶自洁模式\n\n最终结论：\n\n- **「桶自洁」 / 「筒自洁」 → 程序 key：`ssp`**\n- **「桶自洁（全）」 → 程序 key：`tube_clean_all`**\n\n这一步非常重要，因为直接用错程序 key 会导致程序执行的模式不符合预期。\n\n---\n\n## 六、在 OpenClaw 里编排洗衣机逻辑（ha-orchestrator）\n\n单纯有 `homeassistant` skill 还不够，它只是能发送 API 请求。  \n为了让 Clawdbot 理解“帮我打开洗衣机，程序为桶自洁”这种自然语言，我又加了一个编排 skill：`ha-orchestrator`。\n\n### 6.1 ha-orchestrator 的职责\n\n- 把“人话”解析成：\n  - 具体控制的设备（洗衣机）\n  - 使用哪个程序（`ssp` / `tube_clean_all`）\n  - 应该按什么顺序调用哪些 HA 服务\n- 然后调用底层的 `homeassistant` skill 完成实际的 API 请求\n\n### 6.2 洗衣机相关约定\n\n在 `ha-orchestrator` 的文档中，我记录了以下约定：\n\n**实体：**\n\n- 电源：`switch.208907217759387_power`  \n- 启停：`switch.208907217759387_control_status`  \n- 程序选择：`select.208907217759387_program`\n\n**程序映射：**\n\n- “桶自洁 / 筒自洁 / 桶清洁” → `ssp`\n- “桶自洁全 / 强力桶自洁 / 全桶自洁” → `tube_clean_all`\n\n### 6.3 指令模板：开始桶自洁（`ssp`）\n\n当用户说：\n\n- “开始洗衣机筒自洁”\n- “开始洗衣机桶自洁”\n- “帮我打开洗衣机，程序为桶自洁”\n\nha-orchestrator 会解析成以下步骤：\n\n1. 打开电源：\n   ```sh\n   curl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n     -H \"Authorization: Bearer $HA_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"entity_id\": \"switch.208907217759387_power\"}'\n   ```\n2. 设置程序为 `ssp`：\n   ```sh\n   curl -s -X POST \"$HA_URL/api/services/select/select_option\" \\\n     -H \"Authorization: Bearer $HA_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\n       \"entity_id\": \"select.208907217759387_program\",\n       \"option\": \"ssp\"\n     }'\n   ```\n3. 启动程序：\n   ```sh\n   curl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n     -H \"Authorization: Bearer $HA_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"entity_id\": \"switch.208907217759387_control_status\"}'\n   ```\n\n### 6.4 指令模板：桶自洁（全）（`tube_clean_all`）\n\n当用户的说法中明确包含“全”：\n\n- “桶自洁全”\n- “强力桶自洁”\n- “全桶自洁”\n\n则映射为 `tube_clean_all`：\n\n```sh\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_power\"}'\n\ncurl -s -X POST \"$HA_URL/api/services/select/select_option\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"entity_id\": \"select.208907217759387_program\",\n    \"option\": \"tube_clean_all\"\n  }'\n\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_control_status\"}'\n```\n\n### 6.5 停止洗衣机的指令\n\n当用户说：\n\n- “停止洗衣机”\n- “取消当前洗衣机程序”\n- “把洗衣机关了”\n\n则执行：\n\n```sh\n# 1. 停止当前程序\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_off\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_control_status\"}'\n\n# 2. 可选：关掉电源\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_off\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_power\"}'\n```\n\n---\n\n## 七、对话控制链路：从一句话到桶自洁（2 月 3 日）\n\n在一切就绪后，我发出了这样一句话：\n\n> 「帮我打开洗衣机，程序为桶自洁」\n\nClawdbot 做的事情大致可以拆成：\n\n1. **意图识别**  \n   - 设备：洗衣机  \n   - 程序：桶自洁（非“全”）\n2. **调用 ha-orchestrator**  \n   - 根据文档映射“桶自洁” → 程序 key `ssp`\n   - 确认实体：\n     - `switch.208907217759387_power`\n     - `select.208907217759387_program`\n     - `switch.208907217759387_control_status`\n3. **通过 homeassistant skill 调用 HA API**  \n   - 依次发送三条 HTTP 请求：\n     1. 打开电源  \n     2. 设置程序为 `ssp`  \n     3. 启动控制开关\n4. **执行结果反馈**  \n   \n   最终聊天里给我的反馈类似：\n   > 已经帮你开启洗衣机，并设置为「桶自洁」程序并启动了。等程序跑完记得把门敞一会儿通风就更好了。\n\n从这一步开始，洗衣机就按照桶自洁程序在跑了。\n\n---\n\n## 八、时间线小结\n\n按时间顺序回顾一下整个过程：\n\n1. **部署 Home Assistant（2 月 2 日）**  \n   - 在雨云服务器上通过 Docker / 1Panel 达成 HA 部署  \n   - 完成 Web 端初始化\n2. **为 OpenClaw 配置 HA_URL / HA_TOKEN（2 月 2 日）**  \n   - 在 HA 中生成 Long-Lived Token  \n   - 在 `openclaw-gateway.service` 的 systemd override 中注入 `HA_URL` / `HA_TOKEN`  \n   - 重启网关，使 `homeassistant` skill 可以直接访问 HA API\n3. **安装 HACS + Midea Auto Cloud 并接入洗衣机（2 月 2 日 ～ 2 月 3 日）**  \n   - 通过 HACS 安装 Midea Auto Cloud  \n   - 用美的账号绑定洗衣机  \n   - 在实体列表中确认 washing machine 相关实体存在\n4. **确认实体 ID 和程序 key（2 月 3 日）**  \n   - 找到洗衣机的电源 / 启停 / 程序选择实体 ID  \n   - 验证「筒自洁」实际对应程序 key 为 `ssp`，而不是 `tube_clean_all`\n5. **在 ha-orchestrator 中固化映射规则（2 月 3 日）**  \n   - 人话 → 程序 key：  \n     - 桶自洁 → `ssp`  \n     - 桶自洁全 → `tube_clean_all`\n   - 人话 → 服务调用序列（电源 → 选程序 → 启动）\n6. **自然语言调通桶自洁（2 月 3 日）**  \n   - 对 Clawdbot 说：“帮我打开洗衣机，程序为桶自洁”  \n   - Clawdbot 自动调用 HA 完成整套操作，并在聊天中反馈结果\n\n---\n\n## 九、后续可以做的扩展\n\n有了这套链路之后，后面可以自然拓展到其他家电：\n\n- 客厅 / 卧室空调：\n  - “把客厅空调设到 26 度制冷”\n- 热水器：\n  - “打开热水器，30 分钟后提醒我关掉”\n- 多设备场景：\n  - “回家模式：打开客厅灯 + 开空调 26 度制冷 + 播放客厅音箱 BGM”\n\n只要在 `ha-orchestrator` 中持续维护：\n\n1. **实体映射表**：自然语言名称 → HA 实体 ID  \n2. **语义 → 参数和服务**：如温度、模式、时长等  \n3. **安全检查**：比如洗衣机门锁状态、错误码等\n\n就可以让自然语言控制整个家，而不仅仅是洗衣机。\n","source":"_posts/Home-Assistant-OpenClaw.md","raw":"title: Home Assistant + OpenClaw\nauthor: blog-author\ndate: 2026-02-03 08:35:11\ncategories:\n  - 服务器\ntags:\n  - AI\n  - openclaw\n  - home assistant\n  - 瞎鼓捣\n---\n# 从 0 到 能说话控制洗衣机：Home Assistant + 美的美居 + OpenClaw 实战记录\n\n> 记录一下我在雨云服务器上从零搭建 Home Assistant，接入美的洗衣机，然后用 OpenClaw / Clawdbot 做到“说一句话就帮我跑桶自洁”的完整过程。  \n时间线大致是：**部署 HA → 配环境变量 → 安装集成 → 接入美的洗衣机 → 调通桶自洁程序 → 对话控制链路**。\n\n---\n\n## 一、环境与目标\n\n- 服务器：雨云 VPS\n- 系统：Ubuntu Server 22.04 LTS\n- 面板：1Panel\n- 目标：\n  - 在这台服务器上部署 Home Assistant\n  - 接入美的洗衣机（美的云 / Midea Auto Cloud）\n  - 在 OpenClaw / Clawdbot 中通过自然语言控制洗衣机（例如“帮我打开洗衣机，程序为桶自洁”）\n\n---\n\n## 二、部署 Home Assistant（2 月 2 日）\n\n### 2.1 部署方式选择\n\nHome Assistant 官方支持多种方式：\n\n- Home Assistant OS（整机镜像）\n- Home Assistant Container（Docker）\n- Home Assistant Core（Python venv）\n\n我的环境本身就有 1Panel 和 Docker，所以选择了 **Home Assistant Container**，方便运维和备份。\n\n### 2.2 Docker 启动 Home Assistant\n\n在服务器上执行（也可以用 1Panel 图形界面对照配置）：\n\n```sh\ndocker run -d \\\n  --name homeassistant \\\n  --restart=unless-stopped \\\n  -e TZ=Asia/Shanghai \\\n  -v /opt/homeassistant/config:/config \\\n  --net=host \\\n  ghcr.io/home-assistant/home-assistant:stable\n```\n\n关键点：\n\n- `--net=host`：方便 Home Assistant 使用 8123 端口和发现局域网设备  \n- `-v /opt/homeassistant/config:/config`：配置持久化到宿主机  \n- `TZ=Asia/Shanghai`：时区设置为国内时间\n\n部署后，浏览器访问：\n\n```text\nhttp://<服务器 IP>:8123\n```\n\n按 Web 引导完成 HA 的初始用户、密码及基础配置。\n\n---\n\n## 三、为 OpenClaw 准备 HA API 环境（2 月 2 日）\n\n为了让 Clawdbot 能通过 Home Assistant 的 API 控制设备，需要在 OpenClaw 的网关进程里配置两个环境变量：\n\n- `HA_URL`：Home Assistant 的访问地址\n- `HA_TOKEN`：Home Assistant 的长效访问令牌（Long-Lived Access Token）\n\n### 3.1 在 Home Assistant 创建 Long-Lived Token\n\n在 HA Web 界面中：\n\n1. 右上角点击头像 → “**个人资料**”\n2. 滚到页面最底部，找到 **长效访问令牌**\n3. 新建一个令牌（例如命名为 `openclaw-gateway`）\n4. 复制生成的 Token（只会显示一次）\n\n### 3.2 给 OpenClaw 网关注入环境变量\n\nOpenClaw 网关是一个 systemd 用户服务：`openclaw-gateway.service`。\n\n编辑 override：\n\n```sh\nsystemctl --user edit openclaw-gateway.service\n```\n\n在弹出的编辑器中增加：\n\n```ini\n[Service]\nEnvironment=HA_URL=http://127.0.0.1:8123\nEnvironment=HA_TOKEN=<从 HA 生成的 Long-Lived Token>\n```\n\n保存后执行：\n\n```sh\nsystemctl --user daemon-reload\nsystemctl --user restart openclaw-gateway.service\n```\n\n检查环境变量是否生效（例如通过 `ps e` 或日志）可以看到：\n\n```text\nHA_URL=http://127.0.0.1:8123\nHA_TOKEN=<same token>\n```\n\n到此，OpenClaw 内置的 `homeassistant` skill 已具备访问 HA API 的能力。\n\n---\n\n## 四、安装 Midea Auto Cloud 集成并接入美的洗衣机\n\n> 这一段是核心前置：让 Home Assistant 认识洗衣机。\n\n### 4.1 安装 HACS（如未安装）\n\nHACS 是 Home Assistant 的“第三方商店”，很多社区集成都通过它安装。\n\n简单步骤：\n\n1. SSH 到服务器，进入 HA 的配置目录（容器挂载点），比如：\n   ```sh\n   cd /opt/homeassistant/config\n   ```\n2. 一键安装脚本：\n   ```sh\n   wget -O - https://get.hacs.xyz | bash -\n   ```\n3. 重启 Home Assistant 容器：\n   ```sh\n   docker restart homeassistant\n   ```\n4. Web UI 中按照 HACS 文档完成初次配置。  \n成功后左侧菜单会出现 `HACS`。\n\n### 4.2 安装并配置 Midea Auto Cloud\n\n1. 在 HACS → **Integrations** 中搜索并安装 `Midea Auto Cloud` 集成\n2. 安装完成后重启 HA\n3. 进入：设置 → 设备与服务 → 添加集成  \n搜索 `Midea Auto Cloud`，按提示用美的 / MSmartHome / 美居账号登录绑定\n4. 完成后，到 **设备与实体列表** 中确认美的洗衣机已经以多个实体的形式出现\n\n到这里，洗衣机已经“出现在” Home Assistant 中了，接下来就只剩下找准实体 ID 和程序。\n\n---\n\n## 五、确认洗衣机实体与可用程序（2 月 3 日）\n\n在这一步，需要从 HA 的实体列表中找到与洗衣机有关的几类实体。\n\n### 5.1 关键实体 ID\n\n最终确认的几个关键实体如下（你的设备 ID 可能不同）：\n\n- 电源开关：`switch.208907217759387_power`  \n- 启停控制：`switch.208907217759387_control_status`  \n- 程序选择：`select.208907217759387_program`  \n- 运行状态：`sensor.208907217759387_running_status`\n\n可以通过 HA 的开发者工具 → 状态，或者 API：\n\n```sh\ncurl -s \"$HA_URL/api/states\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" | jq '.[] | select(.entity_id | contains(\"208907217759387\"))'\n```\n\n来过滤只和洗衣机相关的实体。\n\n### 5.2 程序列表与「桶自洁」对应关系\n\n`select.208907217759387_program` 的属性中有一个 `options` 列表，展示所有支持的程序，例如（节选）：\n\n```json\n\"options\": [\n  \"cotton\",\n  \"eco\",\n  \"fast_wash\",\n  \"mixed_wash\",\n  \"wool\",\n  \"ssp\",\n  ...\n  \"tube_clean_all\",\n  ...\n]\n```\n\n通过实际操作验证：\n\n- 在美的 App / HA 前端选择 UI 上显示的「筒自洁」，  \n观察 `select.208907217759387_program` 的状态，发现它变成了：`ssp`  \n- `options` 列表里还有一个 `tube_clean_all`，对应的是“更彻底”的桶自洁模式\n\n最终结论：\n\n- **「桶自洁」 / 「筒自洁」 → 程序 key：`ssp`**\n- **「桶自洁（全）」 → 程序 key：`tube_clean_all`**\n\n这一步非常重要，因为直接用错程序 key 会导致程序执行的模式不符合预期。\n\n---\n\n## 六、在 OpenClaw 里编排洗衣机逻辑（ha-orchestrator）\n\n单纯有 `homeassistant` skill 还不够，它只是能发送 API 请求。  \n为了让 Clawdbot 理解“帮我打开洗衣机，程序为桶自洁”这种自然语言，我又加了一个编排 skill：`ha-orchestrator`。\n\n### 6.1 ha-orchestrator 的职责\n\n- 把“人话”解析成：\n  - 具体控制的设备（洗衣机）\n  - 使用哪个程序（`ssp` / `tube_clean_all`）\n  - 应该按什么顺序调用哪些 HA 服务\n- 然后调用底层的 `homeassistant` skill 完成实际的 API 请求\n\n### 6.2 洗衣机相关约定\n\n在 `ha-orchestrator` 的文档中，我记录了以下约定：\n\n**实体：**\n\n- 电源：`switch.208907217759387_power`  \n- 启停：`switch.208907217759387_control_status`  \n- 程序选择：`select.208907217759387_program`\n\n**程序映射：**\n\n- “桶自洁 / 筒自洁 / 桶清洁” → `ssp`\n- “桶自洁全 / 强力桶自洁 / 全桶自洁” → `tube_clean_all`\n\n### 6.3 指令模板：开始桶自洁（`ssp`）\n\n当用户说：\n\n- “开始洗衣机筒自洁”\n- “开始洗衣机桶自洁”\n- “帮我打开洗衣机，程序为桶自洁”\n\nha-orchestrator 会解析成以下步骤：\n\n1. 打开电源：\n   ```sh\n   curl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n     -H \"Authorization: Bearer $HA_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"entity_id\": \"switch.208907217759387_power\"}'\n   ```\n2. 设置程序为 `ssp`：\n   ```sh\n   curl -s -X POST \"$HA_URL/api/services/select/select_option\" \\\n     -H \"Authorization: Bearer $HA_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\n       \"entity_id\": \"select.208907217759387_program\",\n       \"option\": \"ssp\"\n     }'\n   ```\n3. 启动程序：\n   ```sh\n   curl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n     -H \"Authorization: Bearer $HA_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"entity_id\": \"switch.208907217759387_control_status\"}'\n   ```\n\n### 6.4 指令模板：桶自洁（全）（`tube_clean_all`）\n\n当用户的说法中明确包含“全”：\n\n- “桶自洁全”\n- “强力桶自洁”\n- “全桶自洁”\n\n则映射为 `tube_clean_all`：\n\n```sh\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_power\"}'\n\ncurl -s -X POST \"$HA_URL/api/services/select/select_option\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"entity_id\": \"select.208907217759387_program\",\n    \"option\": \"tube_clean_all\"\n  }'\n\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_on\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_control_status\"}'\n```\n\n### 6.5 停止洗衣机的指令\n\n当用户说：\n\n- “停止洗衣机”\n- “取消当前洗衣机程序”\n- “把洗衣机关了”\n\n则执行：\n\n```sh\n# 1. 停止当前程序\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_off\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_control_status\"}'\n\n# 2. 可选：关掉电源\ncurl -s -X POST \"$HA_URL/api/services/switch/turn_off\" \\\n  -H \"Authorization: Bearer $HA_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"entity_id\": \"switch.208907217759387_power\"}'\n```\n\n---\n\n## 七、对话控制链路：从一句话到桶自洁（2 月 3 日）\n\n在一切就绪后，我发出了这样一句话：\n\n> 「帮我打开洗衣机，程序为桶自洁」\n\nClawdbot 做的事情大致可以拆成：\n\n1. **意图识别**  \n   - 设备：洗衣机  \n   - 程序：桶自洁（非“全”）\n2. **调用 ha-orchestrator**  \n   - 根据文档映射“桶自洁” → 程序 key `ssp`\n   - 确认实体：\n     - `switch.208907217759387_power`\n     - `select.208907217759387_program`\n     - `switch.208907217759387_control_status`\n3. **通过 homeassistant skill 调用 HA API**  \n   - 依次发送三条 HTTP 请求：\n     1. 打开电源  \n     2. 设置程序为 `ssp`  \n     3. 启动控制开关\n4. **执行结果反馈**  \n   \n   最终聊天里给我的反馈类似：\n   > 已经帮你开启洗衣机，并设置为「桶自洁」程序并启动了。等程序跑完记得把门敞一会儿通风就更好了。\n\n从这一步开始，洗衣机就按照桶自洁程序在跑了。\n\n---\n\n## 八、时间线小结\n\n按时间顺序回顾一下整个过程：\n\n1. **部署 Home Assistant（2 月 2 日）**  \n   - 在雨云服务器上通过 Docker / 1Panel 达成 HA 部署  \n   - 完成 Web 端初始化\n2. **为 OpenClaw 配置 HA_URL / HA_TOKEN（2 月 2 日）**  \n   - 在 HA 中生成 Long-Lived Token  \n   - 在 `openclaw-gateway.service` 的 systemd override 中注入 `HA_URL` / `HA_TOKEN`  \n   - 重启网关，使 `homeassistant` skill 可以直接访问 HA API\n3. **安装 HACS + Midea Auto Cloud 并接入洗衣机（2 月 2 日 ～ 2 月 3 日）**  \n   - 通过 HACS 安装 Midea Auto Cloud  \n   - 用美的账号绑定洗衣机  \n   - 在实体列表中确认 washing machine 相关实体存在\n4. **确认实体 ID 和程序 key（2 月 3 日）**  \n   - 找到洗衣机的电源 / 启停 / 程序选择实体 ID  \n   - 验证「筒自洁」实际对应程序 key 为 `ssp`，而不是 `tube_clean_all`\n5. **在 ha-orchestrator 中固化映射规则（2 月 3 日）**  \n   - 人话 → 程序 key：  \n     - 桶自洁 → `ssp`  \n     - 桶自洁全 → `tube_clean_all`\n   - 人话 → 服务调用序列（电源 → 选程序 → 启动）\n6. **自然语言调通桶自洁（2 月 3 日）**  \n   - 对 Clawdbot 说：“帮我打开洗衣机，程序为桶自洁”  \n   - Clawdbot 自动调用 HA 完成整套操作，并在聊天中反馈结果\n\n---\n\n## 九、后续可以做的扩展\n\n有了这套链路之后，后面可以自然拓展到其他家电：\n\n- 客厅 / 卧室空调：\n  - “把客厅空调设到 26 度制冷”\n- 热水器：\n  - “打开热水器，30 分钟后提醒我关掉”\n- 多设备场景：\n  - “回家模式：打开客厅灯 + 开空调 26 度制冷 + 播放客厅音箱 BGM”\n\n只要在 `ha-orchestrator` 中持续维护：\n\n1. **实体映射表**：自然语言名称 → HA 实体 ID  \n2. **语义 → 参数和服务**：如温度、模式、时长等  \n3. **安全检查**：比如洗衣机门锁状态、错误码等\n\n就可以让自然语言控制整个家，而不仅仅是洗衣机。\n","slug":"Home-Assistant-OpenClaw","published":1,"updated":"2026-02-03T09:30:34.918Z","comments":1,"layout":"post","photos":[],"_id":"cuidU7484USFQs-DFnKai1uY4","content":"<h1 id=\"从-0-到-能说话控制洗衣机：Home-Assistant-美的美居-OpenClaw-实战记录\"><a href=\"#从-0-到-能说话控制洗衣机：Home-Assistant-美的美居-OpenClaw-实战记录\" class=\"headerlink\" title=\"从 0 到 能说话控制洗衣机：Home Assistant + 美的美居 + OpenClaw 实战记录\"></a>从 0 到 能说话控制洗衣机：Home Assistant + 美的美居 + OpenClaw 实战记录</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>记录一下我在雨云服务器上从零搭建 Home Assistant，接入美的洗衣机，然后用 OpenClaw &#x2F; Clawdbot 做到“说一句话就帮我跑桶自洁”的完整过程。<br>时间线大致是：<strong>部署 HA → 配环境变量 → 安装集成 → 接入美的洗衣机 → 调通桶自洁程序 → 对话控制链路</strong>。</p></blockquote>\n<hr>\n<h2 id=\"一、环境与目标\"><a href=\"#一、环境与目标\" class=\"headerlink\" title=\"一、环境与目标\"></a>一、环境与目标</h2><ul>\n<li>服务器：雨云 VPS</li>\n<li>系统：Ubuntu Server 22.04 LTS</li>\n<li>面板：1Panel</li>\n<li>目标：<ul>\n<li>在这台服务器上部署 Home Assistant</li>\n<li>接入美的洗衣机（美的云 &#x2F; Midea Auto Cloud）</li>\n<li>在 OpenClaw &#x2F; Clawdbot 中通过自然语言控制洗衣机（例如“帮我打开洗衣机，程序为桶自洁”）</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"二、部署-Home-Assistant（2-月-2-日）\"><a href=\"#二、部署-Home-Assistant（2-月-2-日）\" class=\"headerlink\" title=\"二、部署 Home Assistant（2 月 2 日）\"></a>二、部署 Home Assistant（2 月 2 日）</h2><h3 id=\"2-1-部署方式选择\"><a href=\"#2-1-部署方式选择\" class=\"headerlink\" title=\"2.1 部署方式选择\"></a>2.1 部署方式选择</h3><p>Home Assistant 官方支持多种方式：</p>\n<ul>\n<li>Home Assistant OS（整机镜像）</li>\n<li>Home Assistant Container（Docker）</li>\n<li>Home Assistant Core（Python venv）</li>\n</ul>\n<p>我的环境本身就有 1Panel 和 Docker，所以选择了 <strong>Home Assistant Container</strong>，方便运维和备份。</p>\n<h3 id=\"2-2-Docker-启动-Home-Assistant\"><a href=\"#2-2-Docker-启动-Home-Assistant\" class=\"headerlink\" title=\"2.2 Docker 启动 Home Assistant\"></a>2.2 Docker 启动 Home Assistant</h3><p>在服务器上执行（也可以用 1Panel 图形界面对照配置）：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name homeassistant \\</span><br><span class=\"line\">  --restart=unless-stopped \\</span><br><span class=\"line\">  -e TZ=Asia/Shanghai \\</span><br><span class=\"line\">  -v /opt/homeassistant/config:/config \\</span><br><span class=\"line\">  --net=host \\</span><br><span class=\"line\">  ghcr.io/home-assistant/home-assistant:stable</span><br></pre></td></tr></table></figure>\n\n<p>关键点：</p>\n<ul>\n<li><code>--net=host</code>：方便 Home Assistant 使用 8123 端口和发现局域网设备  </li>\n<li><code>-v /opt/homeassistant/config:/config</code>：配置持久化到宿主机  </li>\n<li><code>TZ=Asia/Shanghai</code>：时区设置为国内时间</li>\n</ul>\n<p>部署后，浏览器访问：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://&lt;服务器 IP&gt;:8123</span><br></pre></td></tr></table></figure>\n\n<p>按 Web 引导完成 HA 的初始用户、密码及基础配置。</p>\n<hr>\n<h2 id=\"三、为-OpenClaw-准备-HA-API-环境（2-月-2-日）\"><a href=\"#三、为-OpenClaw-准备-HA-API-环境（2-月-2-日）\" class=\"headerlink\" title=\"三、为 OpenClaw 准备 HA API 环境（2 月 2 日）\"></a>三、为 OpenClaw 准备 HA API 环境（2 月 2 日）</h2><p>为了让 Clawdbot 能通过 Home Assistant 的 API 控制设备，需要在 OpenClaw 的网关进程里配置两个环境变量：</p>\n<ul>\n<li><code>HA_URL</code>：Home Assistant 的访问地址</li>\n<li><code>HA_TOKEN</code>：Home Assistant 的长效访问令牌（Long-Lived Access Token）</li>\n</ul>\n<h3 id=\"3-1-在-Home-Assistant-创建-Long-Lived-Token\"><a href=\"#3-1-在-Home-Assistant-创建-Long-Lived-Token\" class=\"headerlink\" title=\"3.1 在 Home Assistant 创建 Long-Lived Token\"></a>3.1 在 Home Assistant 创建 Long-Lived Token</h3><p>在 HA Web 界面中：</p>\n<ol>\n<li>右上角点击头像 → “<strong>个人资料</strong>”</li>\n<li>滚到页面最底部，找到 <strong>长效访问令牌</strong></li>\n<li>新建一个令牌（例如命名为 <code>openclaw-gateway</code>）</li>\n<li>复制生成的 Token（只会显示一次）</li>\n</ol>\n<h3 id=\"3-2-给-OpenClaw-网关注入环境变量\"><a href=\"#3-2-给-OpenClaw-网关注入环境变量\" class=\"headerlink\" title=\"3.2 给 OpenClaw 网关注入环境变量\"></a>3.2 给 OpenClaw 网关注入环境变量</h3><p>OpenClaw 网关是一个 systemd 用户服务：<code>openclaw-gateway.service</code>。</p>\n<p>编辑 override：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl --user edit openclaw-gateway.service</span><br></pre></td></tr></table></figure>\n\n<p>在弹出的编辑器中增加：</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[Service]</span></span><br><span class=\"line\"><span class=\"attr\">Environment</span>=HA_URL=http://<span class=\"number\">127.0</span>.<span class=\"number\">0.1</span>:<span class=\"number\">8123</span></span><br><span class=\"line\"><span class=\"attr\">Environment</span>=HA_TOKEN=&lt;从 HA 生成的 Long-Lived Token&gt;</span><br></pre></td></tr></table></figure>\n\n<p>保存后执行：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl --user daemon-reload</span><br><span class=\"line\">systemctl --user restart openclaw-gateway.service</span><br></pre></td></tr></table></figure>\n\n<p>检查环境变量是否生效（例如通过 <code>ps e</code> 或日志）可以看到：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HA_URL=http://127.0.0.1:8123</span><br><span class=\"line\">HA_TOKEN=&lt;same token&gt;</span><br></pre></td></tr></table></figure>\n\n<p>到此，OpenClaw 内置的 <code>homeassistant</code> skill 已具备访问 HA API 的能力。</p>\n<hr>\n<h2 id=\"四、安装-Midea-Auto-Cloud-集成并接入美的洗衣机\"><a href=\"#四、安装-Midea-Auto-Cloud-集成并接入美的洗衣机\" class=\"headerlink\" title=\"四、安装 Midea Auto Cloud 集成并接入美的洗衣机\"></a>四、安装 Midea Auto Cloud 集成并接入美的洗衣机</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这一段是核心前置：让 Home Assistant 认识洗衣机。</p></blockquote>\n<h3 id=\"4-1-安装-HACS（如未安装）\"><a href=\"#4-1-安装-HACS（如未安装）\" class=\"headerlink\" title=\"4.1 安装 HACS（如未安装）\"></a>4.1 安装 HACS（如未安装）</h3><p>HACS 是 Home Assistant 的“第三方商店”，很多社区集成都通过它安装。</p>\n<p>简单步骤：</p>\n<ol>\n<li>SSH 到服务器，进入 HA 的配置目录（容器挂载点），比如：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/homeassistant/config</span><br></pre></td></tr></table></figure></li>\n<li>一键安装脚本：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O - https://get.hacs.xyz | bash -</span><br></pre></td></tr></table></figure></li>\n<li>重启 Home Assistant 容器：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker restart homeassistant</span><br></pre></td></tr></table></figure></li>\n<li>Web UI 中按照 HACS 文档完成初次配置。<br>成功后左侧菜单会出现 <code>HACS</code>。</li>\n</ol>\n<h3 id=\"4-2-安装并配置-Midea-Auto-Cloud\"><a href=\"#4-2-安装并配置-Midea-Auto-Cloud\" class=\"headerlink\" title=\"4.2 安装并配置 Midea Auto Cloud\"></a>4.2 安装并配置 Midea Auto Cloud</h3><ol>\n<li>在 HACS → <strong>Integrations</strong> 中搜索并安装 <code>Midea Auto Cloud</code> 集成</li>\n<li>安装完成后重启 HA</li>\n<li>进入：设置 → 设备与服务 → 添加集成<br>搜索 <code>Midea Auto Cloud</code>，按提示用美的 &#x2F; MSmartHome &#x2F; 美居账号登录绑定</li>\n<li>完成后，到 <strong>设备与实体列表</strong> 中确认美的洗衣机已经以多个实体的形式出现</li>\n</ol>\n<p>到这里，洗衣机已经“出现在” Home Assistant 中了，接下来就只剩下找准实体 ID 和程序。</p>\n<hr>\n<h2 id=\"五、确认洗衣机实体与可用程序（2-月-3-日）\"><a href=\"#五、确认洗衣机实体与可用程序（2-月-3-日）\" class=\"headerlink\" title=\"五、确认洗衣机实体与可用程序（2 月 3 日）\"></a>五、确认洗衣机实体与可用程序（2 月 3 日）</h2><p>在这一步，需要从 HA 的实体列表中找到与洗衣机有关的几类实体。</p>\n<h3 id=\"5-1-关键实体-ID\"><a href=\"#5-1-关键实体-ID\" class=\"headerlink\" title=\"5.1 关键实体 ID\"></a>5.1 关键实体 ID</h3><p>最终确认的几个关键实体如下（你的设备 ID 可能不同）：</p>\n<ul>\n<li>电源开关：<code>switch.208907217759387_power</code>  </li>\n<li>启停控制：<code>switch.208907217759387_control_status</code>  </li>\n<li>程序选择：<code>select.208907217759387_program</code>  </li>\n<li>运行状态：<code>sensor.208907217759387_running_status</code></li>\n</ul>\n<p>可以通过 HA 的开发者工具 → 状态，或者 API：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/states&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> | jq <span class=\"string\">&#x27;.[] | select(.entity_id | contains(&quot;208907217759387&quot;))&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>来过滤只和洗衣机相关的实体。</p>\n<h3 id=\"5-2-程序列表与「桶自洁」对应关系\"><a href=\"#5-2-程序列表与「桶自洁」对应关系\" class=\"headerlink\" title=\"5.2 程序列表与「桶自洁」对应关系\"></a>5.2 程序列表与「桶自洁」对应关系</h3><p><code>select.208907217759387_program</code> 的属性中有一个 <code>options</code> 列表，展示所有支持的程序，例如（节选）：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">&quot;options&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">  <span class=\"string\">&quot;cotton&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;eco&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;fast_wash&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;mixed_wash&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;wool&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;ssp&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"string\">&quot;tube_clean_all&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"punctuation\">]</span></span><br></pre></td></tr></table></figure>\n\n<p>通过实际操作验证：</p>\n<ul>\n<li>在美的 App &#x2F; HA 前端选择 UI 上显示的「筒自洁」，<br>观察 <code>select.208907217759387_program</code> 的状态，发现它变成了：<code>ssp</code>  </li>\n<li><code>options</code> 列表里还有一个 <code>tube_clean_all</code>，对应的是“更彻底”的桶自洁模式</li>\n</ul>\n<p>最终结论：</p>\n<ul>\n<li><strong>「桶自洁」 &#x2F; 「筒自洁」 → 程序 key：<code>ssp</code></strong></li>\n<li><strong>「桶自洁（全）」 → 程序 key：<code>tube_clean_all</code></strong></li>\n</ul>\n<p>这一步非常重要，因为直接用错程序 key 会导致程序执行的模式不符合预期。</p>\n<hr>\n<h2 id=\"六、在-OpenClaw-里编排洗衣机逻辑（ha-orchestrator）\"><a href=\"#六、在-OpenClaw-里编排洗衣机逻辑（ha-orchestrator）\" class=\"headerlink\" title=\"六、在 OpenClaw 里编排洗衣机逻辑（ha-orchestrator）\"></a>六、在 OpenClaw 里编排洗衣机逻辑（ha-orchestrator）</h2><p>单纯有 <code>homeassistant</code> skill 还不够，它只是能发送 API 请求。<br>为了让 Clawdbot 理解“帮我打开洗衣机，程序为桶自洁”这种自然语言，我又加了一个编排 skill：<code>ha-orchestrator</code>。</p>\n<h3 id=\"6-1-ha-orchestrator-的职责\"><a href=\"#6-1-ha-orchestrator-的职责\" class=\"headerlink\" title=\"6.1 ha-orchestrator 的职责\"></a>6.1 ha-orchestrator 的职责</h3><ul>\n<li>把“人话”解析成：<ul>\n<li>具体控制的设备（洗衣机）</li>\n<li>使用哪个程序（<code>ssp</code> &#x2F; <code>tube_clean_all</code>）</li>\n<li>应该按什么顺序调用哪些 HA 服务</li>\n</ul>\n</li>\n<li>然后调用底层的 <code>homeassistant</code> skill 完成实际的 API 请求</li>\n</ul>\n<h3 id=\"6-2-洗衣机相关约定\"><a href=\"#6-2-洗衣机相关约定\" class=\"headerlink\" title=\"6.2 洗衣机相关约定\"></a>6.2 洗衣机相关约定</h3><p>在 <code>ha-orchestrator</code> 的文档中，我记录了以下约定：</p>\n<p><strong>实体：</strong></p>\n<ul>\n<li>电源：<code>switch.208907217759387_power</code>  </li>\n<li>启停：<code>switch.208907217759387_control_status</code>  </li>\n<li>程序选择：<code>select.208907217759387_program</code></li>\n</ul>\n<p><strong>程序映射：</strong></p>\n<ul>\n<li>“桶自洁 &#x2F; 筒自洁 &#x2F; 桶清洁” → <code>ssp</code></li>\n<li>“桶自洁全 &#x2F; 强力桶自洁 &#x2F; 全桶自洁” → <code>tube_clean_all</code></li>\n</ul>\n<h3 id=\"6-3-指令模板：开始桶自洁（ssp）\"><a href=\"#6-3-指令模板：开始桶自洁（ssp）\" class=\"headerlink\" title=\"6.3 指令模板：开始桶自洁（ssp）\"></a>6.3 指令模板：开始桶自洁（<code>ssp</code>）</h3><p>当用户说：</p>\n<ul>\n<li>“开始洗衣机筒自洁”</li>\n<li>“开始洗衣机桶自洁”</li>\n<li>“帮我打开洗衣机，程序为桶自洁”</li>\n</ul>\n<p>ha-orchestrator 会解析成以下步骤：</p>\n<ol>\n<li>打开电源：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_power&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>\n<li>设置程序为 <code>ssp</code>：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/select/select_option&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;</span></span><br><span class=\"line\"><span class=\"string\">    &quot;entity_id&quot;: &quot;select.208907217759387_program&quot;,</span></span><br><span class=\"line\"><span class=\"string\">    &quot;option&quot;: &quot;ssp&quot;</span></span><br><span class=\"line\"><span class=\"string\">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>\n<li>启动程序：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_control_status&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"6-4-指令模板：桶自洁（全）（tube-clean-all）\"><a href=\"#6-4-指令模板：桶自洁（全）（tube-clean-all）\" class=\"headerlink\" title=\"6.4 指令模板：桶自洁（全）（tube_clean_all）\"></a>6.4 指令模板：桶自洁（全）（<code>tube_clean_all</code>）</h3><p>当用户的说法中明确包含“全”：</p>\n<ul>\n<li>“桶自洁全”</li>\n<li>“强力桶自洁”</li>\n<li>“全桶自洁”</li>\n</ul>\n<p>则映射为 <code>tube_clean_all</code>：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_power&quot;&#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/select/select_option&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;</span></span><br><span class=\"line\"><span class=\"string\">    &quot;entity_id&quot;: &quot;select.208907217759387_program&quot;,</span></span><br><span class=\"line\"><span class=\"string\">    &quot;option&quot;: &quot;tube_clean_all&quot;</span></span><br><span class=\"line\"><span class=\"string\">  &#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_control_status&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-5-停止洗衣机的指令\"><a href=\"#6-5-停止洗衣机的指令\" class=\"headerlink\" title=\"6.5 停止洗衣机的指令\"></a>6.5 停止洗衣机的指令</h3><p>当用户说：</p>\n<ul>\n<li>“停止洗衣机”</li>\n<li>“取消当前洗衣机程序”</li>\n<li>“把洗衣机关了”</li>\n</ul>\n<p>则执行：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1. 停止当前程序</span></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_off&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_control_status&quot;&#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. 可选：关掉电源</span></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_off&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_power&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"七、对话控制链路：从一句话到桶自洁（2-月-3-日）\"><a href=\"#七、对话控制链路：从一句话到桶自洁（2-月-3-日）\" class=\"headerlink\" title=\"七、对话控制链路：从一句话到桶自洁（2 月 3 日）\"></a>七、对话控制链路：从一句话到桶自洁（2 月 3 日）</h2><p>在一切就绪后，我发出了这样一句话：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>「帮我打开洗衣机，程序为桶自洁」</p></blockquote>\n<p>Clawdbot 做的事情大致可以拆成：</p>\n<ol>\n<li><p><strong>意图识别</strong>  </p>\n<ul>\n<li>设备：洗衣机  </li>\n<li>程序：桶自洁（非“全”）</li>\n</ul>\n</li>\n<li><p><strong>调用 ha-orchestrator</strong>  </p>\n<ul>\n<li>根据文档映射“桶自洁” → 程序 key <code>ssp</code></li>\n<li>确认实体：<ul>\n<li><code>switch.208907217759387_power</code></li>\n<li><code>select.208907217759387_program</code></li>\n<li><code>switch.208907217759387_control_status</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>通过 homeassistant skill 调用 HA API</strong>  </p>\n<ul>\n<li>依次发送三条 HTTP 请求：<ol>\n<li>打开电源  </li>\n<li>设置程序为 <code>ssp</code>  </li>\n<li>启动控制开关</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p><strong>执行结果反馈</strong>  </p>\n<p>最终聊天里给我的反馈类似：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>已经帮你开启洗衣机，并设置为「桶自洁」程序并启动了。等程序跑完记得把门敞一会儿通风就更好了。</p></blockquote>\n</li>\n</ol>\n<p>从这一步开始，洗衣机就按照桶自洁程序在跑了。</p>\n<hr>\n<h2 id=\"八、时间线小结\"><a href=\"#八、时间线小结\" class=\"headerlink\" title=\"八、时间线小结\"></a>八、时间线小结</h2><p>按时间顺序回顾一下整个过程：</p>\n<ol>\n<li><strong>部署 Home Assistant（2 月 2 日）</strong>  <ul>\n<li>在雨云服务器上通过 Docker &#x2F; 1Panel 达成 HA 部署  </li>\n<li>完成 Web 端初始化</li>\n</ul>\n</li>\n<li><strong>为 OpenClaw 配置 HA_URL &#x2F; HA_TOKEN（2 月 2 日）</strong>  <ul>\n<li>在 HA 中生成 Long-Lived Token  </li>\n<li>在 <code>openclaw-gateway.service</code> 的 systemd override 中注入 <code>HA_URL</code> &#x2F; <code>HA_TOKEN</code>  </li>\n<li>重启网关，使 <code>homeassistant</code> skill 可以直接访问 HA API</li>\n</ul>\n</li>\n<li><strong>安装 HACS + Midea Auto Cloud 并接入洗衣机（2 月 2 日 ～ 2 月 3 日）</strong>  <ul>\n<li>通过 HACS 安装 Midea Auto Cloud  </li>\n<li>用美的账号绑定洗衣机  </li>\n<li>在实体列表中确认 washing machine 相关实体存在</li>\n</ul>\n</li>\n<li><strong>确认实体 ID 和程序 key（2 月 3 日）</strong>  <ul>\n<li>找到洗衣机的电源 &#x2F; 启停 &#x2F; 程序选择实体 ID  </li>\n<li>验证「筒自洁」实际对应程序 key 为 <code>ssp</code>，而不是 <code>tube_clean_all</code></li>\n</ul>\n</li>\n<li><strong>在 ha-orchestrator 中固化映射规则（2 月 3 日）</strong>  <ul>\n<li>人话 → 程序 key：  <ul>\n<li>桶自洁 → <code>ssp</code>  </li>\n<li>桶自洁全 → <code>tube_clean_all</code></li>\n</ul>\n</li>\n<li>人话 → 服务调用序列（电源 → 选程序 → 启动）</li>\n</ul>\n</li>\n<li><strong>自然语言调通桶自洁（2 月 3 日）</strong>  <ul>\n<li>对 Clawdbot 说：“帮我打开洗衣机，程序为桶自洁”  </li>\n<li>Clawdbot 自动调用 HA 完成整套操作，并在聊天中反馈结果</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"九、后续可以做的扩展\"><a href=\"#九、后续可以做的扩展\" class=\"headerlink\" title=\"九、后续可以做的扩展\"></a>九、后续可以做的扩展</h2><p>有了这套链路之后，后面可以自然拓展到其他家电：</p>\n<ul>\n<li>客厅 &#x2F; 卧室空调：<ul>\n<li>“把客厅空调设到 26 度制冷”</li>\n</ul>\n</li>\n<li>热水器：<ul>\n<li>“打开热水器，30 分钟后提醒我关掉”</li>\n</ul>\n</li>\n<li>多设备场景：<ul>\n<li>“回家模式：打开客厅灯 + 开空调 26 度制冷 + 播放客厅音箱 BGM”</li>\n</ul>\n</li>\n</ul>\n<p>只要在 <code>ha-orchestrator</code> 中持续维护：</p>\n<ol>\n<li><strong>实体映射表</strong>：自然语言名称 → HA 实体 ID  </li>\n<li><strong>语义 → 参数和服务</strong>：如温度、模式、时长等  </li>\n<li><strong>安全检查</strong>：比如洗衣机门锁状态、错误码等</li>\n</ol>\n<p>就可以让自然语言控制整个家，而不仅仅是洗衣机。</p>\n","excerpt":"","more":"<h1 id=\"从-0-到-能说话控制洗衣机：Home-Assistant-美的美居-OpenClaw-实战记录\"><a href=\"#从-0-到-能说话控制洗衣机：Home-Assistant-美的美居-OpenClaw-实战记录\" class=\"headerlink\" title=\"从 0 到 能说话控制洗衣机：Home Assistant + 美的美居 + OpenClaw 实战记录\"></a>从 0 到 能说话控制洗衣机：Home Assistant + 美的美居 + OpenClaw 实战记录</h1><blockquote>\n<p>记录一下我在雨云服务器上从零搭建 Home Assistant，接入美的洗衣机，然后用 OpenClaw &#x2F; Clawdbot 做到“说一句话就帮我跑桶自洁”的完整过程。<br>时间线大致是：<strong>部署 HA → 配环境变量 → 安装集成 → 接入美的洗衣机 → 调通桶自洁程序 → 对话控制链路</strong>。</p>\n</blockquote>\n<hr>\n<h2 id=\"一、环境与目标\"><a href=\"#一、环境与目标\" class=\"headerlink\" title=\"一、环境与目标\"></a>一、环境与目标</h2><ul>\n<li>服务器：雨云 VPS</li>\n<li>系统：Ubuntu Server 22.04 LTS</li>\n<li>面板：1Panel</li>\n<li>目标：<ul>\n<li>在这台服务器上部署 Home Assistant</li>\n<li>接入美的洗衣机（美的云 &#x2F; Midea Auto Cloud）</li>\n<li>在 OpenClaw &#x2F; Clawdbot 中通过自然语言控制洗衣机（例如“帮我打开洗衣机，程序为桶自洁”）</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"二、部署-Home-Assistant（2-月-2-日）\"><a href=\"#二、部署-Home-Assistant（2-月-2-日）\" class=\"headerlink\" title=\"二、部署 Home Assistant（2 月 2 日）\"></a>二、部署 Home Assistant（2 月 2 日）</h2><h3 id=\"2-1-部署方式选择\"><a href=\"#2-1-部署方式选择\" class=\"headerlink\" title=\"2.1 部署方式选择\"></a>2.1 部署方式选择</h3><p>Home Assistant 官方支持多种方式：</p>\n<ul>\n<li>Home Assistant OS（整机镜像）</li>\n<li>Home Assistant Container（Docker）</li>\n<li>Home Assistant Core（Python venv）</li>\n</ul>\n<p>我的环境本身就有 1Panel 和 Docker，所以选择了 <strong>Home Assistant Container</strong>，方便运维和备份。</p>\n<h3 id=\"2-2-Docker-启动-Home-Assistant\"><a href=\"#2-2-Docker-启动-Home-Assistant\" class=\"headerlink\" title=\"2.2 Docker 启动 Home Assistant\"></a>2.2 Docker 启动 Home Assistant</h3><p>在服务器上执行（也可以用 1Panel 图形界面对照配置）：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name homeassistant \\</span><br><span class=\"line\">  --restart=unless-stopped \\</span><br><span class=\"line\">  -e TZ=Asia/Shanghai \\</span><br><span class=\"line\">  -v /opt/homeassistant/config:/config \\</span><br><span class=\"line\">  --net=host \\</span><br><span class=\"line\">  ghcr.io/home-assistant/home-assistant:stable</span><br></pre></td></tr></table></figure>\n\n<p>关键点：</p>\n<ul>\n<li><code>--net=host</code>：方便 Home Assistant 使用 8123 端口和发现局域网设备  </li>\n<li><code>-v /opt/homeassistant/config:/config</code>：配置持久化到宿主机  </li>\n<li><code>TZ=Asia/Shanghai</code>：时区设置为国内时间</li>\n</ul>\n<p>部署后，浏览器访问：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://&lt;服务器 IP&gt;:8123</span><br></pre></td></tr></table></figure>\n\n<p>按 Web 引导完成 HA 的初始用户、密码及基础配置。</p>\n<hr>\n<h2 id=\"三、为-OpenClaw-准备-HA-API-环境（2-月-2-日）\"><a href=\"#三、为-OpenClaw-准备-HA-API-环境（2-月-2-日）\" class=\"headerlink\" title=\"三、为 OpenClaw 准备 HA API 环境（2 月 2 日）\"></a>三、为 OpenClaw 准备 HA API 环境（2 月 2 日）</h2><p>为了让 Clawdbot 能通过 Home Assistant 的 API 控制设备，需要在 OpenClaw 的网关进程里配置两个环境变量：</p>\n<ul>\n<li><code>HA_URL</code>：Home Assistant 的访问地址</li>\n<li><code>HA_TOKEN</code>：Home Assistant 的长效访问令牌（Long-Lived Access Token）</li>\n</ul>\n<h3 id=\"3-1-在-Home-Assistant-创建-Long-Lived-Token\"><a href=\"#3-1-在-Home-Assistant-创建-Long-Lived-Token\" class=\"headerlink\" title=\"3.1 在 Home Assistant 创建 Long-Lived Token\"></a>3.1 在 Home Assistant 创建 Long-Lived Token</h3><p>在 HA Web 界面中：</p>\n<ol>\n<li>右上角点击头像 → “<strong>个人资料</strong>”</li>\n<li>滚到页面最底部，找到 <strong>长效访问令牌</strong></li>\n<li>新建一个令牌（例如命名为 <code>openclaw-gateway</code>）</li>\n<li>复制生成的 Token（只会显示一次）</li>\n</ol>\n<h3 id=\"3-2-给-OpenClaw-网关注入环境变量\"><a href=\"#3-2-给-OpenClaw-网关注入环境变量\" class=\"headerlink\" title=\"3.2 给 OpenClaw 网关注入环境变量\"></a>3.2 给 OpenClaw 网关注入环境变量</h3><p>OpenClaw 网关是一个 systemd 用户服务：<code>openclaw-gateway.service</code>。</p>\n<p>编辑 override：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl --user edit openclaw-gateway.service</span><br></pre></td></tr></table></figure>\n\n<p>在弹出的编辑器中增加：</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[Service]</span></span><br><span class=\"line\"><span class=\"attr\">Environment</span>=HA_URL=http://<span class=\"number\">127.0</span>.<span class=\"number\">0.1</span>:<span class=\"number\">8123</span></span><br><span class=\"line\"><span class=\"attr\">Environment</span>=HA_TOKEN=&lt;从 HA 生成的 Long-Lived Token&gt;</span><br></pre></td></tr></table></figure>\n\n<p>保存后执行：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl --user daemon-reload</span><br><span class=\"line\">systemctl --user restart openclaw-gateway.service</span><br></pre></td></tr></table></figure>\n\n<p>检查环境变量是否生效（例如通过 <code>ps e</code> 或日志）可以看到：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HA_URL=http://127.0.0.1:8123</span><br><span class=\"line\">HA_TOKEN=&lt;same token&gt;</span><br></pre></td></tr></table></figure>\n\n<p>到此，OpenClaw 内置的 <code>homeassistant</code> skill 已具备访问 HA API 的能力。</p>\n<hr>\n<h2 id=\"四、安装-Midea-Auto-Cloud-集成并接入美的洗衣机\"><a href=\"#四、安装-Midea-Auto-Cloud-集成并接入美的洗衣机\" class=\"headerlink\" title=\"四、安装 Midea Auto Cloud 集成并接入美的洗衣机\"></a>四、安装 Midea Auto Cloud 集成并接入美的洗衣机</h2><blockquote>\n<p>这一段是核心前置：让 Home Assistant 认识洗衣机。</p>\n</blockquote>\n<h3 id=\"4-1-安装-HACS（如未安装）\"><a href=\"#4-1-安装-HACS（如未安装）\" class=\"headerlink\" title=\"4.1 安装 HACS（如未安装）\"></a>4.1 安装 HACS（如未安装）</h3><p>HACS 是 Home Assistant 的“第三方商店”，很多社区集成都通过它安装。</p>\n<p>简单步骤：</p>\n<ol>\n<li>SSH 到服务器，进入 HA 的配置目录（容器挂载点），比如：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /opt/homeassistant/config</span><br></pre></td></tr></table></figure></li>\n<li>一键安装脚本：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O - https://get.hacs.xyz | bash -</span><br></pre></td></tr></table></figure></li>\n<li>重启 Home Assistant 容器：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker restart homeassistant</span><br></pre></td></tr></table></figure></li>\n<li>Web UI 中按照 HACS 文档完成初次配置。<br>成功后左侧菜单会出现 <code>HACS</code>。</li>\n</ol>\n<h3 id=\"4-2-安装并配置-Midea-Auto-Cloud\"><a href=\"#4-2-安装并配置-Midea-Auto-Cloud\" class=\"headerlink\" title=\"4.2 安装并配置 Midea Auto Cloud\"></a>4.2 安装并配置 Midea Auto Cloud</h3><ol>\n<li>在 HACS → <strong>Integrations</strong> 中搜索并安装 <code>Midea Auto Cloud</code> 集成</li>\n<li>安装完成后重启 HA</li>\n<li>进入：设置 → 设备与服务 → 添加集成<br>搜索 <code>Midea Auto Cloud</code>，按提示用美的 &#x2F; MSmartHome &#x2F; 美居账号登录绑定</li>\n<li>完成后，到 <strong>设备与实体列表</strong> 中确认美的洗衣机已经以多个实体的形式出现</li>\n</ol>\n<p>到这里，洗衣机已经“出现在” Home Assistant 中了，接下来就只剩下找准实体 ID 和程序。</p>\n<hr>\n<h2 id=\"五、确认洗衣机实体与可用程序（2-月-3-日）\"><a href=\"#五、确认洗衣机实体与可用程序（2-月-3-日）\" class=\"headerlink\" title=\"五、确认洗衣机实体与可用程序（2 月 3 日）\"></a>五、确认洗衣机实体与可用程序（2 月 3 日）</h2><p>在这一步，需要从 HA 的实体列表中找到与洗衣机有关的几类实体。</p>\n<h3 id=\"5-1-关键实体-ID\"><a href=\"#5-1-关键实体-ID\" class=\"headerlink\" title=\"5.1 关键实体 ID\"></a>5.1 关键实体 ID</h3><p>最终确认的几个关键实体如下（你的设备 ID 可能不同）：</p>\n<ul>\n<li>电源开关：<code>switch.208907217759387_power</code>  </li>\n<li>启停控制：<code>switch.208907217759387_control_status</code>  </li>\n<li>程序选择：<code>select.208907217759387_program</code>  </li>\n<li>运行状态：<code>sensor.208907217759387_running_status</code></li>\n</ul>\n<p>可以通过 HA 的开发者工具 → 状态，或者 API：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/states&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> | jq <span class=\"string\">&#x27;.[] | select(.entity_id | contains(&quot;208907217759387&quot;))&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>来过滤只和洗衣机相关的实体。</p>\n<h3 id=\"5-2-程序列表与「桶自洁」对应关系\"><a href=\"#5-2-程序列表与「桶自洁」对应关系\" class=\"headerlink\" title=\"5.2 程序列表与「桶自洁」对应关系\"></a>5.2 程序列表与「桶自洁」对应关系</h3><p><code>select.208907217759387_program</code> 的属性中有一个 <code>options</code> 列表，展示所有支持的程序，例如（节选）：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">&quot;options&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">  <span class=\"string\">&quot;cotton&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;eco&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;fast_wash&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;mixed_wash&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;wool&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"string\">&quot;ssp&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"string\">&quot;tube_clean_all&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"punctuation\">]</span></span><br></pre></td></tr></table></figure>\n\n<p>通过实际操作验证：</p>\n<ul>\n<li>在美的 App &#x2F; HA 前端选择 UI 上显示的「筒自洁」，<br>观察 <code>select.208907217759387_program</code> 的状态，发现它变成了：<code>ssp</code>  </li>\n<li><code>options</code> 列表里还有一个 <code>tube_clean_all</code>，对应的是“更彻底”的桶自洁模式</li>\n</ul>\n<p>最终结论：</p>\n<ul>\n<li><strong>「桶自洁」 &#x2F; 「筒自洁」 → 程序 key：<code>ssp</code></strong></li>\n<li><strong>「桶自洁（全）」 → 程序 key：<code>tube_clean_all</code></strong></li>\n</ul>\n<p>这一步非常重要，因为直接用错程序 key 会导致程序执行的模式不符合预期。</p>\n<hr>\n<h2 id=\"六、在-OpenClaw-里编排洗衣机逻辑（ha-orchestrator）\"><a href=\"#六、在-OpenClaw-里编排洗衣机逻辑（ha-orchestrator）\" class=\"headerlink\" title=\"六、在 OpenClaw 里编排洗衣机逻辑（ha-orchestrator）\"></a>六、在 OpenClaw 里编排洗衣机逻辑（ha-orchestrator）</h2><p>单纯有 <code>homeassistant</code> skill 还不够，它只是能发送 API 请求。<br>为了让 Clawdbot 理解“帮我打开洗衣机，程序为桶自洁”这种自然语言，我又加了一个编排 skill：<code>ha-orchestrator</code>。</p>\n<h3 id=\"6-1-ha-orchestrator-的职责\"><a href=\"#6-1-ha-orchestrator-的职责\" class=\"headerlink\" title=\"6.1 ha-orchestrator 的职责\"></a>6.1 ha-orchestrator 的职责</h3><ul>\n<li>把“人话”解析成：<ul>\n<li>具体控制的设备（洗衣机）</li>\n<li>使用哪个程序（<code>ssp</code> &#x2F; <code>tube_clean_all</code>）</li>\n<li>应该按什么顺序调用哪些 HA 服务</li>\n</ul>\n</li>\n<li>然后调用底层的 <code>homeassistant</code> skill 完成实际的 API 请求</li>\n</ul>\n<h3 id=\"6-2-洗衣机相关约定\"><a href=\"#6-2-洗衣机相关约定\" class=\"headerlink\" title=\"6.2 洗衣机相关约定\"></a>6.2 洗衣机相关约定</h3><p>在 <code>ha-orchestrator</code> 的文档中，我记录了以下约定：</p>\n<p><strong>实体：</strong></p>\n<ul>\n<li>电源：<code>switch.208907217759387_power</code>  </li>\n<li>启停：<code>switch.208907217759387_control_status</code>  </li>\n<li>程序选择：<code>select.208907217759387_program</code></li>\n</ul>\n<p><strong>程序映射：</strong></p>\n<ul>\n<li>“桶自洁 &#x2F; 筒自洁 &#x2F; 桶清洁” → <code>ssp</code></li>\n<li>“桶自洁全 &#x2F; 强力桶自洁 &#x2F; 全桶自洁” → <code>tube_clean_all</code></li>\n</ul>\n<h3 id=\"6-3-指令模板：开始桶自洁（ssp）\"><a href=\"#6-3-指令模板：开始桶自洁（ssp）\" class=\"headerlink\" title=\"6.3 指令模板：开始桶自洁（ssp）\"></a>6.3 指令模板：开始桶自洁（<code>ssp</code>）</h3><p>当用户说：</p>\n<ul>\n<li>“开始洗衣机筒自洁”</li>\n<li>“开始洗衣机桶自洁”</li>\n<li>“帮我打开洗衣机，程序为桶自洁”</li>\n</ul>\n<p>ha-orchestrator 会解析成以下步骤：</p>\n<ol>\n<li>打开电源：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_power&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>\n<li>设置程序为 <code>ssp</code>：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/select/select_option&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;</span></span><br><span class=\"line\"><span class=\"string\">    &quot;entity_id&quot;: &quot;select.208907217759387_program&quot;,</span></span><br><span class=\"line\"><span class=\"string\">    &quot;option&quot;: &quot;ssp&quot;</span></span><br><span class=\"line\"><span class=\"string\">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>\n<li>启动程序：<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_control_status&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"6-4-指令模板：桶自洁（全）（tube-clean-all）\"><a href=\"#6-4-指令模板：桶自洁（全）（tube-clean-all）\" class=\"headerlink\" title=\"6.4 指令模板：桶自洁（全）（tube_clean_all）\"></a>6.4 指令模板：桶自洁（全）（<code>tube_clean_all</code>）</h3><p>当用户的说法中明确包含“全”：</p>\n<ul>\n<li>“桶自洁全”</li>\n<li>“强力桶自洁”</li>\n<li>“全桶自洁”</li>\n</ul>\n<p>则映射为 <code>tube_clean_all</code>：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_power&quot;&#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/select/select_option&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;</span></span><br><span class=\"line\"><span class=\"string\">    &quot;entity_id&quot;: &quot;select.208907217759387_program&quot;,</span></span><br><span class=\"line\"><span class=\"string\">    &quot;option&quot;: &quot;tube_clean_all&quot;</span></span><br><span class=\"line\"><span class=\"string\">  &#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_on&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_control_status&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-5-停止洗衣机的指令\"><a href=\"#6-5-停止洗衣机的指令\" class=\"headerlink\" title=\"6.5 停止洗衣机的指令\"></a>6.5 停止洗衣机的指令</h3><p>当用户说：</p>\n<ul>\n<li>“停止洗衣机”</li>\n<li>“取消当前洗衣机程序”</li>\n<li>“把洗衣机关了”</li>\n</ul>\n<p>则执行：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1. 停止当前程序</span></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_off&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_control_status&quot;&#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. 可选：关掉电源</span></span><br><span class=\"line\">curl -s -X POST <span class=\"string\">&quot;<span class=\"variable\">$HA_URL</span>/api/services/switch/turn_off&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Authorization: Bearer <span class=\"variable\">$HA_TOKEN</span>&quot;</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">&quot;Content-Type: application/json&quot;</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">&#x27;&#123;&quot;entity_id&quot;: &quot;switch.208907217759387_power&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"七、对话控制链路：从一句话到桶自洁（2-月-3-日）\"><a href=\"#七、对话控制链路：从一句话到桶自洁（2-月-3-日）\" class=\"headerlink\" title=\"七、对话控制链路：从一句话到桶自洁（2 月 3 日）\"></a>七、对话控制链路：从一句话到桶自洁（2 月 3 日）</h2><p>在一切就绪后，我发出了这样一句话：</p>\n<blockquote>\n<p>「帮我打开洗衣机，程序为桶自洁」</p>\n</blockquote>\n<p>Clawdbot 做的事情大致可以拆成：</p>\n<ol>\n<li><p><strong>意图识别</strong>  </p>\n<ul>\n<li>设备：洗衣机  </li>\n<li>程序：桶自洁（非“全”）</li>\n</ul>\n</li>\n<li><p><strong>调用 ha-orchestrator</strong>  </p>\n<ul>\n<li>根据文档映射“桶自洁” → 程序 key <code>ssp</code></li>\n<li>确认实体：<ul>\n<li><code>switch.208907217759387_power</code></li>\n<li><code>select.208907217759387_program</code></li>\n<li><code>switch.208907217759387_control_status</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>通过 homeassistant skill 调用 HA API</strong>  </p>\n<ul>\n<li>依次发送三条 HTTP 请求：<ol>\n<li>打开电源  </li>\n<li>设置程序为 <code>ssp</code>  </li>\n<li>启动控制开关</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p><strong>执行结果反馈</strong>  </p>\n<p>最终聊天里给我的反馈类似：</p>\n<blockquote>\n<p>已经帮你开启洗衣机，并设置为「桶自洁」程序并启动了。等程序跑完记得把门敞一会儿通风就更好了。</p>\n</blockquote>\n</li>\n</ol>\n<p>从这一步开始，洗衣机就按照桶自洁程序在跑了。</p>\n<hr>\n<h2 id=\"八、时间线小结\"><a href=\"#八、时间线小结\" class=\"headerlink\" title=\"八、时间线小结\"></a>八、时间线小结</h2><p>按时间顺序回顾一下整个过程：</p>\n<ol>\n<li><strong>部署 Home Assistant（2 月 2 日）</strong>  <ul>\n<li>在雨云服务器上通过 Docker &#x2F; 1Panel 达成 HA 部署  </li>\n<li>完成 Web 端初始化</li>\n</ul>\n</li>\n<li><strong>为 OpenClaw 配置 HA_URL &#x2F; HA_TOKEN（2 月 2 日）</strong>  <ul>\n<li>在 HA 中生成 Long-Lived Token  </li>\n<li>在 <code>openclaw-gateway.service</code> 的 systemd override 中注入 <code>HA_URL</code> &#x2F; <code>HA_TOKEN</code>  </li>\n<li>重启网关，使 <code>homeassistant</code> skill 可以直接访问 HA API</li>\n</ul>\n</li>\n<li><strong>安装 HACS + Midea Auto Cloud 并接入洗衣机（2 月 2 日 ～ 2 月 3 日）</strong>  <ul>\n<li>通过 HACS 安装 Midea Auto Cloud  </li>\n<li>用美的账号绑定洗衣机  </li>\n<li>在实体列表中确认 washing machine 相关实体存在</li>\n</ul>\n</li>\n<li><strong>确认实体 ID 和程序 key（2 月 3 日）</strong>  <ul>\n<li>找到洗衣机的电源 &#x2F; 启停 &#x2F; 程序选择实体 ID  </li>\n<li>验证「筒自洁」实际对应程序 key 为 <code>ssp</code>，而不是 <code>tube_clean_all</code></li>\n</ul>\n</li>\n<li><strong>在 ha-orchestrator 中固化映射规则（2 月 3 日）</strong>  <ul>\n<li>人话 → 程序 key：  <ul>\n<li>桶自洁 → <code>ssp</code>  </li>\n<li>桶自洁全 → <code>tube_clean_all</code></li>\n</ul>\n</li>\n<li>人话 → 服务调用序列（电源 → 选程序 → 启动）</li>\n</ul>\n</li>\n<li><strong>自然语言调通桶自洁（2 月 3 日）</strong>  <ul>\n<li>对 Clawdbot 说：“帮我打开洗衣机，程序为桶自洁”  </li>\n<li>Clawdbot 自动调用 HA 完成整套操作，并在聊天中反馈结果</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"九、后续可以做的扩展\"><a href=\"#九、后续可以做的扩展\" class=\"headerlink\" title=\"九、后续可以做的扩展\"></a>九、后续可以做的扩展</h2><p>有了这套链路之后，后面可以自然拓展到其他家电：</p>\n<ul>\n<li>客厅 &#x2F; 卧室空调：<ul>\n<li>“把客厅空调设到 26 度制冷”</li>\n</ul>\n</li>\n<li>热水器：<ul>\n<li>“打开热水器，30 分钟后提醒我关掉”</li>\n</ul>\n</li>\n<li>多设备场景：<ul>\n<li>“回家模式：打开客厅灯 + 开空调 26 度制冷 + 播放客厅音箱 BGM”</li>\n</ul>\n</li>\n</ul>\n<p>只要在 <code>ha-orchestrator</code> 中持续维护：</p>\n<ol>\n<li><strong>实体映射表</strong>：自然语言名称 → HA 实体 ID  </li>\n<li><strong>语义 → 参数和服务</strong>：如温度、模式、时长等  </li>\n<li><strong>安全检查</strong>：比如洗衣机门锁状态、错误码等</li>\n</ol>\n<p>就可以让自然语言控制整个家，而不仅仅是洗衣机。</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cuidU7484USFQs-DFnKai1uY4","category_id":"cuid-gl2pTrS9aQb73bdQmI9J","_id":"cuid-eOAPT1I03rEB8xlQcoCC"},{"post_id":"cuidlZMlInILL-mYReY073pq9","category_id":"cuid-gl2pTrS9aQb73bdQmI9J","_id":"cuiddwhSPKxO1e2Y5VP2cZHv2"},{"post_id":"cuidp0bPflksFZe37R4VInuJv","category_id":"cuid-gl2pTrS9aQb73bdQmI9J","_id":"cuid61t1Plxq-zrVnVuw0LeWw"},{"post_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","category_id":"cuidJ2OVrDiKImc5d8G19wLn_","_id":"cuidnF0yK3__q71gf_p8gPtMZ"}],"PostTag":[{"post_id":"cuidlZMlInILL-mYReY073pq9","tag_id":"cuidd8ns__DOs5W487mFQ0MSK","_id":"cuidDbjXFlDIS4Dc9rcFGtHnl"},{"post_id":"cuidlZMlInILL-mYReY073pq9","tag_id":"cuidRqPoFlhNKY-MkBRs1GUlU","_id":"cuidtxbRdl286c-MVZ1gnFYzw"},{"post_id":"cuidlZMlInILL-mYReY073pq9","tag_id":"cuidS9UOIKt55JPddHFGZnoRH","_id":"cuid-QYHDFzveubmqzk8JEaB_"},{"post_id":"cuidlZMlInILL-mYReY073pq9","tag_id":"cuid6ezGsCCnQssvUECpmq8Rs","_id":"cuidAjFT9hjmP0dStYokGGOMS"},{"post_id":"cuidp0bPflksFZe37R4VInuJv","tag_id":"cuidAbzntY131oR067stkKPOC","_id":"cuidMzh6IvwYA9X2VTDCQ8SX8"},{"post_id":"cuidp0bPflksFZe37R4VInuJv","tag_id":"cuido6m8-bRBH-72s2gkc1Mge","_id":"cuid-w0eJ5vhD5jTPgP3ta7Ow"},{"post_id":"cuidp0bPflksFZe37R4VInuJv","tag_id":"cuidS9UOIKt55JPddHFGZnoRH","_id":"cuidQrco8FJ9CAxBKqh46_Kk7"},{"post_id":"cuidp0bPflksFZe37R4VInuJv","tag_id":"cuidd8ns__DOs5W487mFQ0MSK","_id":"cuidqW2yrXGcfvAaU0ngfhjVa"},{"post_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","tag_id":"cuidxwNmLMcNDPuGwqCYXebIr","_id":"cuids_zj7GzM1-KTN_LDbXvNN"},{"post_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","tag_id":"cuidSsLYwu7g0joI9_Rd-beW2","_id":"cuid602CQtO33jiX_JWdXQm7B"},{"post_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","tag_id":"cuid1UVSqp_43yvUHW9r_9LZs","_id":"cuidCIbkcLsO5pmeNSVjcMMZp"},{"post_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","tag_id":"cuidGEQw3kmBcrtHEOwC8jCK5","_id":"cuidcKGIAUd4NeqVAUywWtKPQ"},{"post_id":"cuidtcIdpfV5GH09Y2ZVNjGOs","tag_id":"cuidDWd1qsIyXsYppsXdlBQPT","_id":"cuid04JiDjC5dUM8NOdOm8nGa"},{"post_id":"cuidU7484USFQs-DFnKai1uY4","tag_id":"cuidcuI-D-DrwyzUinhnzoHCd","_id":"cuideWoMun0XGKU57BTiIFG_S"},{"post_id":"cuidU7484USFQs-DFnKai1uY4","tag_id":"cuidAbzntY131oR067stkKPOC","_id":"cuid45rGJUs2vICMutjGkGCYo"},{"post_id":"cuidU7484USFQs-DFnKai1uY4","tag_id":"cuidw35AWTNuI8YG8r461hf1i","_id":"cuidWkft2JQeNok1ZeQL6buHO"},{"post_id":"cuidU7484USFQs-DFnKai1uY4","tag_id":"cuidS9UOIKt55JPddHFGZnoRH","_id":"cuid1z_vO9O7fa8rA5CmOYhCn"}],"Tag":[{"name":"服务器","_id":"cuidd8ns__DOs5W487mFQ0MSK"},{"name":"博客配置","_id":"cuidRqPoFlhNKY-MkBRs1GUlU"},{"name":"瞎鼓捣","_id":"cuidS9UOIKt55JPddHFGZnoRH"},{"name":"openclaw代笔","_id":"cuid6ezGsCCnQssvUECpmq8Rs"},{"name":"openclaw","_id":"cuidAbzntY131oR067stkKPOC"},{"name":"第三方服务","_id":"cuido6m8-bRBH-72s2gkc1Mge"},{"name":"环境配置","_id":"cuidxwNmLMcNDPuGwqCYXebIr"},{"name":"nvm","_id":"cuidSsLYwu7g0joI9_Rd-beW2"},{"name":"node版本","_id":"cuid1UVSqp_43yvUHW9r_9LZs"},{"name":"前端配置","_id":"cuidGEQw3kmBcrtHEOwC8jCK5"},{"name":"工作积累","_id":"cuidDWd1qsIyXsYppsXdlBQPT"},{"name":"AI","_id":"cuidcuI-D-DrwyzUinhnzoHCd"},{"name":"home assistant","_id":"cuidw35AWTNuI8YG8r461hf1i"}]}}